{"ast":null,"code":"import { ElMessage } from 'element-plus';\nimport { ref, onMounted } from 'vue';\nimport axios from '@/utils/request';\nimport { useRoute } from 'vue-router';\nimport COS from 'cos-js-sdk-v5';\nimport YyButton from \"@/page/components/YyButton.vue\";\nexport default {\n  __name: 'AttachmentContent',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let cos;\n    const route = useRoute();\n    const articleId = parseInt(route.params.id, 10); //路径中的文章ID\n    const emptyDialogVisible2 = ref(false);\n    const attachmentCost = ref({}); //附件需要花费的货币类型及数额\n    const attachmentState = ref({}); //附件购买的状态。0为没有附件，1为未购买，2为已购买,3为不需付费\n    const attachmentPermissionData = ref({}); //附件许可证\n\n    //购买附件接口\n    async function purchaseAttachment(articleId) {\n      try {\n        const response = await axios.post(`/article/attachment/purchase/${articleId}`);\n        if (response.data.code === 1) {\n          loadFile();\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error('购买附件失败', response.data.msg || 'Unknown error');\n          ElMessage.error('购买附件失败');\n        }\n      } catch (error) {\n        console.error('购买附件失败', error.message);\n        ElMessage.error('购买附件失败');\n      }\n    }\n\n    //向后端请求下载当前附件的许可证\n    async function getattachmentPermission() {\n      try {\n        const response = await axios.get(`/article/attachment/download/secret/${articleId}`);\n        if (response.data.code === 1) {\n          attachmentPermissionData.value = response.data.data;\n          updateCOSInstance();\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(response.data.msg || 'Unknown error');\n        }\n      } catch (error) {\n        console.error('向后端请求下载当前附件的许可证', error.message);\n      }\n    }\n\n    //获取附件状态\n    async function fetchAttachmentState(articleId) {\n      try {\n        const response = await axios.get(`/article/attachment/purchaseLog/${articleId}`);\n        if (response.data.code === 1) {\n          attachmentState.value = response.data.map;\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error('获取附件状态失败', response.data.msg || 'Unknown error');\n          ElMessage.error('获取附件状态失败');\n        }\n      } catch (error) {\n        console.error('获取附件状态失败', error.message);\n        ElMessage.error('获取附件状态失败');\n      }\n    }\n\n    //获取附件价格\n    async function fetchAttachmentCost(articleId) {\n      try {\n        const response = await axios.get(`/article/attachment/require/${articleId}`);\n        if (response.data.code === 1) {\n          attachmentCost.value = response.data.map;\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error('获取附件状态失败', response.data.msg || 'Unknown error');\n          ElMessage.error('获取附件状态失败');\n        }\n      } catch (error) {\n        console.error('获取附件状态失败', error.message);\n        ElMessage.error('获取附件状态失败');\n      }\n    }\n    function updateCOSInstance() {\n      cos = new COS({\n        SecretId: attachmentPermissionData.value.tmpSecretId,\n        SecretKey: attachmentPermissionData.value.tmpSecretKey\n      });\n    }\n    const downloadFile = () => {\n      if (!cos) {\n        console.error(\"COS 实例未初始化\");\n        return;\n      }\n      cos.getObjectUrl({\n        Bucket: 'youyu-bucket-attachment-1319554411',\n        Region: 'ap-chengdu',\n        Key: attachmentPermissionData.value.url,\n        onProgress: function (progressData) {\n          console.log(JSON.stringify(progressData));\n        }\n      }, function (err, data) {\n        if (err) {\n          console.log(err);\n          return;\n        }\n        const url = data.Url;\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = attachmentPermissionData.value.url.split('/').pop(); // 提取文件名\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      });\n    };\n    async function loadFile() {\n      await getattachmentPermission(); // 确保先执行并成功获取数据\n      // 检查 COS 实例是否已初始化\n      if (!cos) {\n        console.error(\"COS 实例未初始化\");\n        return;\n      }\n      downloadFile();\n    }\n    onMounted(() => {\n      fetchAttachmentState(articleId);\n      fetchAttachmentCost(articleId);\n    });\n    const __returned__ = {\n      get cos() {\n        return cos;\n      },\n      set cos(v) {\n        cos = v;\n      },\n      route,\n      articleId,\n      emptyDialogVisible2,\n      attachmentCost,\n      attachmentState,\n      attachmentPermissionData,\n      purchaseAttachment,\n      getattachmentPermission,\n      fetchAttachmentState,\n      fetchAttachmentCost,\n      updateCOSInstance,\n      downloadFile,\n      loadFile,\n      get ElMessage() {\n        return ElMessage;\n      },\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      get useRoute() {\n        return useRoute;\n      },\n      get COS() {\n        return COS;\n      },\n      YyButton\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ElMessage","ref","onMounted","axios","useRoute","COS","YyButton","cos","route","articleId","parseInt","params","id","emptyDialogVisible2","attachmentCost","attachmentState","attachmentPermissionData","purchaseAttachment","response","post","data","code","loadFile","msg","error","toString","console","message","getattachmentPermission","get","value","updateCOSInstance","fetchAttachmentState","map","fetchAttachmentCost","SecretId","tmpSecretId","SecretKey","tmpSecretKey","downloadFile","getObjectUrl","Bucket","Region","Key","url","onProgress","progressData","log","JSON","stringify","err","Url","link","document","createElement","href","download","split","pop","body","appendChild","click","removeChild"],"sources":["D:/有渔/前端源码/YouyuBBS-Q - 副本/youyu-lyn-qtnew-vision-new-2024.1.14/src/page/TheArticle/components/AttachmentContent.vue"],"sourcesContent":["<template>\r\n  <div class=\"text_content\"  >\r\n    <div class=\"appendix\">\r\n      <div style=\"display: flex;align-items: center;gap: 5px;\">\r\n        <el-icon><Link /></el-icon>附件\r\n      </div>\r\n      <div v-if=\"attachmentState.type === 0 \" style=\"margin-top: 5px;color: #3779c6;font-size: 14px;\" class=\"blue-text\">\r\n        该文章无附件\r\n      </div>\r\n      <div v-if=\"attachmentState.type === 2  \"  @click=\"loadFile\" class=\"pay blue-text\" >\r\n        该附件已购买,点此下载\r\n      </div>\r\n      <div v-if=\"attachmentState.type === 3  \"  @click=\"loadFile\" class=\"pay blue-text\" >\r\n        该附件无需额外支付费用,点此下载\r\n      </div>\r\n      <div v-if=\"attachmentState.type === 1 \" class=\"pbutton\">\r\n        <div class=\"pheader\">\r\n          <div class=\"lock-icons\">\r\n            <el-icon><Document /></el-icon>\r\n          </div>\r\n          <div class=\"content-right\">\r\n              <div class=\"text-row\">\r\n                <div class=\"ptext\">{{ attachmentState.name }}</div>\r\n                <span class=\"number\">{{ attachmentState.size }}</span>\r\n              </div>\r\n              <div v-if=\"attachmentCost.type === 0 \" class=\"pay\" @click=\"emptyDialogVisible2 = true\">\r\n                获取该附件需支付{{attachmentCost.count}}鱼饵(点此下载)\r\n              </div>\r\n              <div  v-if=\"attachmentCost.type === 1 \" class=\"pay\" @click=\"emptyDialogVisible2 = true\">\r\n                获取该附件需支付{{attachmentCost.count}}渔币(点此下载)\r\n              </div>\r\n              <el-dialog v-model=\"emptyDialogVisible2\" style=\"width: 40%;\">\r\n                <div class=\"centered-content\">\r\n                  <el-icon><Document /></el-icon>\r\n                  <p>{{ attachmentState.name  }}</p>\r\n                </div>\r\n                <div v-if=\"attachmentCost.type === 0 \"  class=\"flex-container\">\r\n                  <p>支付</p>\r\n                  <span class=\"attachment-money\">{{ attachmentCost.count }}</span>\r\n                  <p>个鱼饵以下载该附件</p>\r\n                </div>\r\n                <div  v-if=\"attachmentCost.type === 1 \" class=\"flex-container\">\r\n                  <p>支付</p>\r\n                  <span class=\"attachment-money\">{{ attachmentCost.count }}</span>\r\n                  <p>个渔币以下载该附件</p>\r\n                </div>\r\n                <div class=\"button-container\">\r\n                  <YyButton theme=\"purple\" style=\"padding: 6px 15px;\" @click=\"purchaseAttachment\">确定支付</YyButton>\r\n                  <YyButton theme=\"gray\" style=\"padding: 6px 15px;\" @click=\"emptyDialogVisible2 = false\">取消</YyButton>\r\n                </div>\r\n              </el-dialog>\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ElMessage } from 'element-plus';\r\nimport { ref,onMounted} from 'vue';\r\nimport axios from '@/utils/request';\r\nimport { useRoute  } from 'vue-router'\r\nimport COS from 'cos-js-sdk-v5';\r\nimport YyButton from \"@/page/components/YyButton.vue\";\r\n\r\nlet cos;\r\nconst route = useRoute ();\r\nconst articleId = parseInt(route.params.id,10);//路径中的文章ID\r\nconst emptyDialogVisible2 = ref(false);\r\nconst attachmentCost = ref({});//附件需要花费的货币类型及数额\r\nconst attachmentState = ref({});//附件购买的状态。0为没有附件，1为未购买，2为已购买,3为不需付费\r\nconst attachmentPermissionData = ref({});//附件许可证\r\n\r\n//购买附件接口\r\nasync function purchaseAttachment(articleId) {\r\n  try {\r\n    const response = await axios.post(`/article/attachment/purchase/${articleId}`);\r\n    if (response.data.code === 1) {\r\n      loadFile();\r\n    } else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else {\r\n      console.error('购买附件失败', response.data.msg || 'Unknown error');\r\n      ElMessage.error('购买附件失败');\r\n    }\r\n  } catch (error) {\r\n    console.error('购买附件失败', error.message);\r\n    ElMessage.error('购买附件失败');\r\n  }\r\n}   \r\n\r\n\r\n//向后端请求下载当前附件的许可证\r\nasync function getattachmentPermission() {\r\n  try {\r\n    const response = await axios.get(`/article/attachment/download/secret/${articleId}`)\r\n    if (response.data.code === 1) {\r\n      attachmentPermissionData.value = response.data.data;\r\n      updateCOSInstance();\r\n    } else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else {\r\n      console.error(response.data.msg || 'Unknown error');\r\n    }\r\n  } catch (error) {\r\n    console.error('向后端请求下载当前附件的许可证', error.message);\r\n  }\r\n}\r\n\r\n//获取附件状态\r\nasync function fetchAttachmentState(articleId) {\r\n  try {\r\n    const response = await axios.get(`/article/attachment/purchaseLog/${articleId}`);\r\n    if (response.data.code === 1) {\r\n      attachmentState.value = response.data.map;\r\n    } else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else {\r\n      console.error('获取附件状态失败', response.data.msg || 'Unknown error');\r\n      ElMessage.error('获取附件状态失败');\r\n    }\r\n  } catch (error) {\r\n    console.error('获取附件状态失败', error.message);\r\n    ElMessage.error('获取附件状态失败');\r\n  }\r\n}   \r\n\r\n\r\n//获取附件价格\r\nasync function fetchAttachmentCost(articleId) {\r\n  try {\r\n    const response = await axios.get(`/article/attachment/require/${articleId}`);\r\n    if (response.data.code === 1) {\r\n      attachmentCost.value = response.data.map;\r\n    } else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else {\r\n    console.error('获取附件状态失败', response.data.msg || 'Unknown error');\r\n      ElMessage.error('获取附件状态失败');\r\n    }\r\n  } catch (error) {\r\n    console.error('获取附件状态失败', error.message);\r\n    ElMessage.error('获取附件状态失败');\r\n  }\r\n}\r\n\r\nfunction updateCOSInstance() {\r\n    cos = new COS({\r\n        SecretId: attachmentPermissionData.value.tmpSecretId,\r\n        SecretKey: attachmentPermissionData.value.tmpSecretKey,\r\n    });\r\n}\r\n\r\nconst downloadFile = () => {\r\n  if (!cos) {\r\n    console.error(\"COS 实例未初始化\");\r\n    return;\r\n  }\r\n  cos.getObjectUrl({\r\n    Bucket: 'youyu-bucket-attachment-1319554411',\r\n    Region: 'ap-chengdu',\r\n    Key: attachmentPermissionData.value.url,\r\n    onProgress: function (progressData) {\r\n        console.log(JSON.stringify(progressData));\r\n    }\r\n  }, function(err, data) {\r\n      if (err) {\r\n          console.log(err);\r\n          return;\r\n      }\r\n      const url = data.Url;\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = attachmentPermissionData.value.url.split('/').pop(); // 提取文件名\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n  });\r\n};\r\n\r\nasync function loadFile() {\r\n  await getattachmentPermission(); // 确保先执行并成功获取数据\r\n  // 检查 COS 实例是否已初始化\r\n  if (!cos) {\r\n    console.error(\"COS 实例未初始化\");\r\n    return;\r\n  }\r\n  downloadFile();\r\n}\r\n\r\nonMounted(() => {\r\n    fetchAttachmentState(articleId);\r\n    fetchAttachmentCost(articleId);\r\n});\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.appendix {\r\n  width: 1140px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding-left: 50px;\r\n  margin: 25px auto 0;\r\n}\r\n.appendix span {\r\n  color: #777;\r\n  font-family: Microsoft YaHei;\r\n  margin: 5px;\r\n  font-size: 12px;\r\n}\r\n.appendix .el-icon{\r\n  width: 20px;\r\n  height: 20px;\r\n}\r\n.appendix .el-icon svg{\r\n  width: 20px;\r\n  height: 20px;\r\n}\r\n.pbutton {\r\n  width: 315px;\r\n  height: 50px;\r\n  margin: 20px 0px;\r\n}\r\n.pheader {\r\n  display: flex;\r\n  align-items: flex-start; \r\n  gap: 8px; \r\n}\r\n.content-right {\r\n  display: flex;\r\n  flex-direction: column; \r\n  gap: 8px;\r\n}\r\n.text-row {\r\n  display: flex; \r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n.ptext{\r\n  color: #000;\r\n  font-family: Microsoft YaHei;\r\n  font-size: 14px;\r\n}\r\n.lock-icons{\r\n  width: 45px;\r\n  height: 45px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 4px;\r\n  background: rgba(228, 228, 228, 0.43);\r\n  margin-right: 10px;\r\n}\r\n.centered-content .el-icon{\r\n    height: 25px;\r\n    width: 25px;\r\n}\r\n.centered-content .el-icon svg {\r\n    height: 25px;\r\n    width: 25px;\r\n    color: #666666;\r\n}\r\n\r\n.number{\r\n  color: #777;\r\n  font-family: Microsoft YaHei;\r\n  font-size: 14px;\r\n}\r\n.ptext, .number {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n}\r\n.pay{\r\n  display: block; \r\n  margin-top: -1px; \r\n  cursor: pointer;\r\n  color: #3779C6;\r\n  font-family: Microsoft YaHei;\r\n  font-size: 14px;\r\n}\r\n/* 购买附件弹框 */\r\n.centered-content {\r\n  display: flex;\r\n  flex-direction: column; \r\n  align-items: center; \r\n}\r\n.flex-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center; \r\n  gap: 5px;      \r\n  margin-bottom: 40px;    \r\n}\r\n.attachment-money{\r\n  font-weight: 700;\r\n  font-size: 20px;\r\n}\r\n.button-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin-top: 30px;\r\n  position: absolute;\r\n  right: 10px;\r\n  bottom: 10px;\r\n  gap: 15px;\r\n}\r\n@media (max-width:768px){\r\n  .appendix{\r\n      width: auto;\r\n      padding-left: 0px;\r\n  }\r\n  .appendix .el-icon{\r\n      margin-left: 5%;\r\n  }\r\n  .pheader{\r\n      margin: 0 auto;\r\n      width: 90%;\r\n      justify-content: space-evenly;\r\n      align-items: center;\r\n      gap: 0px;\r\n  }\r\n  .lock-icons{\r\n      width: 2.5rem;\r\n      height: 2.5rem;\r\n      margin-right: 0.5rem;\r\n  }\r\n  .content-right{\r\n      gap: 0.2rem;\r\n  }\r\n  .blue-text{\r\n    margin-left: 5%;\r\n  }\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}