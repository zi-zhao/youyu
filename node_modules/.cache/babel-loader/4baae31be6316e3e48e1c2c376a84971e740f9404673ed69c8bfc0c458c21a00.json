{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-4348b7b2\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"eva_input\"\n};\nconst _hoisted_2 = {\n  class: \"rate_box\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  style: {\n    \"font-weight\": \"700\"\n  }\n}, \"综合评价\", -1 /* HOISTED */));\nconst _hoisted_4 = {\n  class: \"dialog-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_rate = _resolveComponent(\"el-rate\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_el_dialog, {\n    modelValue: $setup.localDialogVisible,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.localDialogVisible = $event),\n    title: \"提问评价\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_4, [_createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $setup.evaluateAnswer\n    }, {\n      default: _withCtx(() => [_createTextVNode(\" 发布 \")]),\n      _: 1 /* STABLE */\n    })])]),\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createVNode(_component_el_input, {\n      modelValue: $setup.textarea,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.textarea = $event),\n      maxlength: \"150\",\n      placeholder: \"分享一下最近的趣事或心情吧\",\n      \"show-word-limit\": \"\",\n      type: \"textarea\",\n      size: \"large\",\n      resize: \"none\",\n      autosize: {\n        minRows: 2,\n        maxRows: 30\n      }\n    }, null, 8 /* PROPS */, [\"modelValue\"])]), _createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createVNode(_component_el_rate, {\n      modelValue: $setup.value,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.value = $event)\n    }, null, 8 /* PROPS */, [\"modelValue\"])])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])]);\n}","map":{"version":3,"names":["class","_createElementVNode","style","_createElementBlock","_createVNode","_component_el_dialog","$setup","localDialogVisible","$event","title","footer","_withCtx","_hoisted_4","_component_el_button","type","onClick","evaluateAnswer","_hoisted_1","_component_el_input","textarea","maxlength","placeholder","size","resize","autosize","minRows","maxRows","_hoisted_2","_hoisted_3","_component_el_rate","value"],"sources":["D:\\有渔\\前端源码\\YouyuBBS-Q - 副本\\youyu-lyn-qtnew-vision-new-2024.1.14\\src\\page\\QACenter\\components\\EvaluateDialog.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-dialog v-model=\"localDialogVisible\" title=\"提问评价\">\r\n        <div class=\"eva_input\">\r\n            <el-input\r\n                v-model=\"textarea\"\r\n                maxlength=\"150\"\r\n                placeholder=\"分享一下最近的趣事或心情吧\"\r\n                show-word-limit\r\n                type=\"textarea\"\r\n                size=\"large\"\r\n                resize=\"none\"\r\n                :autosize = \"{ minRows: 2, maxRows: 30 }\"\r\n            />\r\n        </div>\r\n        <div class=\"rate_box\">\r\n            <span style=\"font-weight: 700;\">综合评价</span>\r\n            <el-rate v-model=\"value\" />\r\n        </div>\r\n        <template #footer>\r\n        <span class=\"dialog-footer\">\r\n            <el-button type=\"primary\" @click=\"evaluateAnswer\">\r\n            发布\r\n            </el-button>\r\n        </span>\r\n        </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref , defineProps ,defineEmits,watchEffect} from 'vue'\r\nimport { ElMessage } from 'element-plus';\r\nimport axios from '@/utils/request';\r\nimport { useRouter } from 'vue-router'\r\n\r\nconst props = defineProps({\r\n    modelValue: Boolean,\r\n    QuestionId:Number,\r\n});\r\n\r\nconst textarea = ref();\r\nconst value = ref();\r\nconst router = useRouter()\r\nconst emit = defineEmits(['update:modelValue']);\r\nconst localDialogVisible = ref(props.modelValue);\r\nwatchEffect(() => {\r\n  if (localDialogVisible.value !== props.modelValue) {\r\n    emit('update:modelValue', localDialogVisible.value);\r\n  }\r\n});\r\n\r\n//对问答评价\r\nasync function evaluateAnswer() {\r\n  try{\r\n    const queryParams = new URLSearchParams({\r\n      id:props.QuestionId,\r\n      content:textarea.value,\r\n      grade:value.value,\r\n    }).toString();\r\n    const response = await axios.post(`/answer/comment?${queryParams}`)\r\n    if(response.data.code === 1){\r\n        ElMessage.success('评价成功');\r\n        localDialogVisible.value = false;\r\n        if (router.currentRoute.value.path === '/DefaultPresentation') {\r\n          location.reload();\r\n        } else {\r\n          router.push('/DefaultPresentation');\r\n        }\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"评价失败\");\r\n        ElMessage.error('评价失败');\r\n    }\r\n  } catch (error) {\r\n    console.error(\"评价失败\", error); \r\n    ElMessage.error('评价失败');\r\n  }\r\n}\r\n\r\n</script>\r\n<style scoped>\r\n::v-deep .el-dialog__body {\r\n  padding: 0px 40px;\r\n}\r\n::v-deep .el-dialog__header{\r\n  padding-bottom: 30px;\r\n  font-weight: 700;\r\n}\r\n::v-deep .el-input ,\r\n::v-deep .el-textarea,\r\n::v-deep .eva_input .el-textarea .el-textarea__inner{\r\n  width: 100%;\r\n  height: 170px !important;\r\n}\r\n::v-deep .el-dialog{\r\n    --el-dialog-width: 35%;\r\n}\r\n::v-deep .el-dialog__header{\r\n    text-align: center;\r\n}\r\n.rate_box{\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 20px;\r\n  margin: 20px 0px;\r\n}\r\n</style>\r\n"],"mappings":";;;EAGaA,KAAK,EAAC;AAAW;;EAYjBA,KAAK,EAAC;AAAU;gEACjBC,mBAAA,CAA2C;EAArCC,KAAyB,EAAzB;IAAA;EAAA;AAAyB,GAAC,MAAI;;EAIlCF,KAAK,EAAC;AAAe;;;;;;uBAnBjCG,mBAAA,CA0BM,cAzBJC,YAAA,CAwBYC,oBAAA;gBAxBQC,MAAA,CAAAC,kBAAkB;+DAAlBD,MAAA,CAAAC,kBAAkB,GAAAC,MAAA;IAAEC,KAAK,EAAC;;IAiB/BC,MAAM,EAAAC,QAAA,CACjB,MAIO,CAJPV,mBAAA,CAIO,QAJPW,UAIO,GAHHR,YAAA,CAEYS,oBAAA;MAFDC,IAAI,EAAC,SAAS;MAAEC,OAAK,EAAET,MAAA,CAAAU;;wBAAgB,MAElD,C,iBAFkD,MAElD,E;;;sBApBJ,MAWM,CAXNf,mBAAA,CAWM,OAXNgB,UAWM,GAVFb,YAAA,CASEc,mBAAA;kBARWZ,MAAA,CAAAa,QAAQ;iEAARb,MAAA,CAAAa,QAAQ,GAAAX,MAAA;MACjBY,SAAS,EAAC,KAAK;MACfC,WAAW,EAAC,eAAe;MAC3B,iBAAe,EAAf,EAAe;MACfP,IAAI,EAAC,UAAU;MACfQ,IAAI,EAAC,OAAO;MACZC,MAAM,EAAC,MAAM;MACZC,QAAQ,EAAI;QAAAC,OAAA;QAAAC,OAAA;MAAA;+CAGrBzB,mBAAA,CAGM,OAHN0B,UAGM,GAFFC,UAA2C,EAC3CxB,YAAA,CAA2ByB,kBAAA;kBAATvB,MAAA,CAAAwB,KAAK;iEAALxB,MAAA,CAAAwB,KAAK,GAAAtB,MAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}