{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, normalizeStyle as _normalizeStyle, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-6aa805b5\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"large_body\"\n};\nconst _hoisted_2 = {\n  class: \"body\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"text\"\n}, \"内容编辑\", -1 /* HOISTED */));\nconst _hoisted_4 = {\n  class: \"show\"\n};\nconst _hoisted_5 = {\n  class: \"picbox\"\n};\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pictext\"\n}, \"图片\", -1 /* HOISTED */));\nconst _hoisted_7 = {\n  key: 0,\n  class: \"picshow\"\n};\nconst _hoisted_8 = {\n  key: 1,\n  class: \"pic_contain\"\n};\nconst _hoisted_9 = {\n  class: \"picshow\"\n};\nconst _hoisted_10 = {\n  class: \"ptitie\"\n};\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pictext\"\n}, \"标题\", -1 /* HOISTED */));\nconst _hoisted_12 = {\n  class: \"mainp\"\n};\nconst _hoisted_13 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pictext\"\n}, \"正文\", -1 /* HOISTED */));\nconst _hoisted_14 = {\n  class: \"mlable\"\n};\nconst _hoisted_15 = {\n  class: \"lable\"\n};\nconst _hoisted_16 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"pictext\"\n}, \"标签\", -1 /* HOISTED */));\nconst _hoisted_17 = {\n  class: \"buttons-container border-container\"\n};\nconst _hoisted_18 = [\"onClick\"];\nconst _hoisted_19 = {\n  class: \"rlable\"\n};\nconst _hoisted_20 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"labletext\"\n}, \"推荐标签：\", -1 /* HOISTED */));\nconst _hoisted_21 = {\n  class: \"buttons-container\"\n};\nconst _hoisted_22 = [\"onClick\"];\nconst _hoisted_23 = {\n  class: \"rlable\"\n};\nconst _hoisted_24 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"labletext\"\n}, \"新建标签：\", -1 /* HOISTED */));\nconst _hoisted_25 = [\"onKeyup\"];\nconst _hoisted_26 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"text2\"\n}, \"发布设置\", -1 /* HOISTED */));\nconst _hoisted_27 = {\n  class: \"classify\"\n};\nconst _hoisted_28 = {\n  class: \"box1\"\n};\nconst _hoisted_29 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"column\"\n}, \"专栏分类\", -1 /* HOISTED */));\nconst _hoisted_30 = {\n  key: 2\n};\nconst _hoisted_31 = {\n  class: \"box1\"\n};\nconst _hoisted_32 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"tclass\"\n}, \"权限设置\", -1 /* HOISTED */));\nconst _hoisted_33 = {\n  class: \"my-2 flex items-center text-sm\"\n};\nconst _hoisted_34 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"ptext\"\n}, \"(所有人公开)\", -1 /* HOISTED */));\nconst _hoisted_35 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"ptext\"\n}, \"(仅自己可见)\", -1 /* HOISTED */));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Plus = _resolveComponent(\"Plus\");\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_CircleCloseFilled = _resolveComponent(\"CircleCloseFilled\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_radio = _resolveComponent(\"el-radio\");\n  const _component_el_radio_group = _resolveComponent(\"el-radio-group\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _createElementVNode(\"div\", null, [_createElementVNode(\"input\", {\n    type: \"file\",\n    ref: \"fileInput\",\n    accept: \"image/*\",\n    style: {\n      \"display\": \"none\"\n    },\n    onChange: $setup.handleImage\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), $setup.imagePreviews.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createVNode(_component_el_icon, {\n    onClick: $setup.triggerImageUpload,\n    style: {\n      \"position\": \"absolute\",\n      \"left\": \"70px\",\n      \"top\": \"70px\",\n      \"font-size\": \"40px\",\n      \"cursor\": \"pointer\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_Plus)]),\n    _: 1 /* STABLE */\n  })])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.imagePreviews, (imagePreview, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"spic\",\n      style: _normalizeStyle({\n        backgroundImage: `url(${imagePreview})`\n      })\n    }, [_createVNode(_component_el_icon, {\n      class: \"delete-btn\",\n      onClick: $event => $setup.removeImage(index)\n    }, {\n      default: _withCtx(() => [_createVNode(_component_CircleCloseFilled)]),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])], 4 /* STYLE */);\n  }), 128 /* KEYED_FRAGMENT */)), _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_el_icon, {\n    onClick: $setup.triggerImageUpload,\n    style: {\n      \"position\": \"absolute\",\n      \"left\": \"70px\",\n      \"top\": \"70px\",\n      \"font-size\": \"40px\",\n      \"cursor\": \"pointer\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_Plus)]),\n    _: 1 /* STABLE */\n  })])]))])]), _createElementVNode(\"div\", _hoisted_10, [_hoisted_11, _createVNode(_component_el_input, {\n    modelValue: $setup.text,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.text = $event),\n    maxlength: \"10\",\n    placeholder: \"填写标题，可能会让更多人感兴趣~\",\n    \"show-word-limit\": \"\",\n    type: \"text\",\n    class: \"eidt-input\"\n  }, null, 8 /* PROPS */, [\"modelValue\"])]), _createElementVNode(\"div\", _hoisted_12, [_hoisted_13, _createVNode(_component_el_input, {\n    modelValue: $setup.textarea,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.textarea = $event),\n    maxlength: \"1000\",\n    placeholder: \"分享一下最近的趣事或心情吧\",\n    \"show-word-limit\": \"\",\n    type: \"textarea\",\n    size: \"large\",\n    resize: \"none\",\n    autosize: {\n      minRows: 2,\n      maxRows: 30\n    },\n    class: \"eidt-input\"\n  }, null, 8 /* PROPS */, [\"modelValue\"])]), _createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_hoisted_16, _createElementVNode(\"div\", _hoisted_17, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.selectedTags, tag => {\n    return _openBlock(), _createElementBlock(\"span\", {\n      key: tag,\n      class: \"tag-btn\"\n    }, [_createTextVNode(_toDisplayString(tag) + \" \", 1 /* TEXT */), _createElementVNode(\"i\", {\n      class: \"delete-btn2\",\n      onClick: $event => $setup.removeTag(tag)\n    }, \"×\", 8 /* PROPS */, _hoisted_18)]);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"div\", _hoisted_19, [_hoisted_20, _createElementVNode(\"div\", _hoisted_21, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.tags, tag => {\n    return _openBlock(), _createElementBlock(\"button\", {\n      key: tag,\n      class: \"tag-btn\",\n      onClick: $event => $setup.addLabel(tag)\n    }, _toDisplayString(tag), 9 /* TEXT, PROPS */, _hoisted_22);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"div\", _hoisted_23, [_hoisted_24, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    placeholder: \"输入后回车可自己创建标签~\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.newTag = $event),\n    onKeyup: _withKeys($setup.addNewTag, [\"enter\"]),\n    class: \"custom-input-size\"\n  }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_25), [[_vModelText, $setup.newTag]])])])]), _hoisted_26, _createElementVNode(\"div\", _hoisted_27, [_createElementVNode(\"div\", _hoisted_28, [_hoisted_29, $setup.popboxes ? (_openBlock(), _createBlock(_component_el_button, {\n    key: 0,\n    class: \"m-2\",\n    onClick: _cache[3] || (_cache[3] = $event => $setup.dialogFormVisible = true)\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"选择分享专栏\")]),\n    _: 1 /* STABLE */\n  })) : (_openBlock(), _createBlock(_component_el_button, {\n    key: 1,\n    class: \"m-2\",\n    onClick: _cache[4] || (_cache[4] = $event => $setup.dialogFormVisible = true)\n  }, {\n    default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.columnName), 1 /* TEXT */)]),\n    _: 1 /* STABLE */\n  })), $setup.dialogFormVisible ? (_openBlock(), _createElementBlock(\"div\", _hoisted_30, [_createVNode($setup[\"CfDialog\"], {\n    modelValue: $setup.dialogFormVisible,\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $setup.dialogFormVisible = $event),\n    onUpdateValue: $setup.handleUpdateValue,\n    ClassifyName: \"分享专栏\"\n  }, null, 8 /* PROPS */, [\"modelValue\"])])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_31, [_hoisted_32, _createElementVNode(\"div\", _hoisted_33, [_createVNode(_component_el_radio_group, {\n    modelValue: $setup.radio1,\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $setup.radio1 = $event),\n    class: \"radio_share\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_radio, {\n      label: \"0\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"公开\"), _hoisted_34]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_radio, {\n      label: \"1\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"私密\"), _hoisted_35]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])])])]), _createElementVNode(\"div\", {\n    class: \"button\"\n  }, [_createCommentVNode(\" <button class=\\\"bottom_btn\\\">取消</button>\\r\\n          <button class=\\\"bottom_btn\\\">保存草稿</button> \"), _createElementVNode(\"button\", {\n    class: \"put\",\n    onClick: $setup.submitToAPI\n  }, \"发布\")])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","for","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","type","ref","accept","style","onChange","$setup","handleImage","imagePreviews","length","_hoisted_7","_createVNode","_component_el_icon","onClick","triggerImageUpload","_component_Plus","_hoisted_8","_Fragment","_renderList","imagePreview","index","key","_normalizeStyle","backgroundImage","$event","removeImage","_component_CircleCloseFilled","_hoisted_9","_hoisted_10","_hoisted_11","_component_el_input","text","maxlength","placeholder","_hoisted_12","_hoisted_13","textarea","size","resize","autosize","minRows","maxRows","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","selectedTags","tag","removeTag","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","tags","addLabel","_hoisted_22","_hoisted_23","_hoisted_24","newTag","onKeyup","_withKeys","addNewTag","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","popboxes","_createBlock","_component_el_button","_cache","dialogFormVisible","columnName","_hoisted_30","onUpdateValue","handleUpdateValue","ClassifyName","_hoisted_31","_hoisted_32","_hoisted_33","_component_el_radio_group","radio1","_component_el_radio","label","_hoisted_34","_hoisted_35","_createCommentVNode","submitToAPI"],"sources":["D:\\有渔\\前端源码\\YouyuBBS-Q - 副本\\youyu-lyn-qtnew-vision-new-2024.1.14\\src\\page\\ShareEditor\\components\\ContentShare.vue"],"sourcesContent":["<template>\r\n  <div class=\"large_body\">\r\n      <div class=\"body\">\r\n        <span class=\"text\">内容编辑</span>\r\n        <div class=\"show\">\r\n          <div class=\"picbox\">\r\n              <span class=\"pictext\">图片</span>\r\n              <div>\r\n                <input type=\"file\" ref=\"fileInput\" accept=\"image/*\" style=\"display: none;\" @change=\"handleImage\" />\r\n                <div v-if=\"imagePreviews.length === 0\" class=\"picshow\"> \r\n                  <el-icon @click=\"triggerImageUpload\" style=\"position: absolute; left: 70px; top: 70px;font-size: 40px;cursor: pointer;\"><Plus /></el-icon>              \r\n                </div>\r\n                <div v-else class=\"pic_contain\">\r\n                  <div v-for=\"(imagePreview, index) in imagePreviews\" :key=\"index\" class=\"spic\" :style=\"{ backgroundImage: `url(${imagePreview})` }\">\r\n                    <el-icon class=\"delete-btn\" @click=\"removeImage(index)\"><CircleCloseFilled /></el-icon>\r\n                  </div>\r\n                  <div class=\"picshow\"> \r\n                    <el-icon @click=\"triggerImageUpload\" style=\"position: absolute; left: 70px; top: 70px;font-size: 40px;cursor: pointer;\"><Plus /></el-icon>              \r\n                  </div>\r\n                </div>\r\n              </div>\r\n          </div>\r\n          <div class=\"ptitie\">\r\n            <span class=\"pictext\">标题</span>               \r\n            <el-input\r\n              v-model=\"text\"\r\n              maxlength=\"10\"\r\n              placeholder=\"填写标题，可能会让更多人感兴趣~\"\r\n              show-word-limit\r\n              type=\"text\"\r\n              class=\"eidt-input\"\r\n            /> \r\n          </div>\r\n          <div class=\"mainp\">\r\n            <span class=\"pictext\">正文</span>\r\n            <el-input\r\n              v-model=\"textarea\"\r\n              maxlength=\"1000\"\r\n              placeholder=\"分享一下最近的趣事或心情吧\"\r\n              show-word-limit\r\n              type=\"textarea\"\r\n              size=\"large\"\r\n              resize=\"none\"\r\n              :autosize = \"{ minRows: 2, maxRows: 30 }\"\r\n              class=\"eidt-input\"\r\n            />\r\n          </div>\r\n          <div class=\"mlable\">\r\n            <div class=\"lable\">\r\n              <span class=\"pictext\">标签</span>\r\n              <div class=\"buttons-container border-container\">\r\n                  \r\n                  <span v-for=\"tag in selectedTags\" :key=\"tag\" class=\"tag-btn\">\r\n                      {{ tag }}\r\n                      <i class=\"delete-btn2\" @click=\"removeTag(tag)\">×</i>\r\n                  </span>\r\n              </div>\r\n            </div>\r\n            <div class=\"rlable\">\r\n              <span class=\"labletext\">推荐标签：</span>\r\n              <div class=\"buttons-container\">\r\n                  <button \r\n                    v-for=\"tag in tags\" \r\n                    :key=\"tag\"\r\n                    class=\"tag-btn\" \r\n                    @click=\"addLabel(tag)\">\r\n                    {{ tag }}\r\n                  </button>\r\n              </div>\r\n            </div>\r\n            <div class=\"rlable\">\r\n              <span class=\"labletext\">新建标签：</span>\r\n              <input \r\n                  type=\"text\" \r\n                  placeholder=\"输入后回车可自己创建标签~\" \r\n                  v-model=\"newTag\" \r\n                  @keyup.enter=\"addNewTag\"\r\n                  class=\"custom-input-size\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <span class=\"text2\">发布设置</span>\r\n        <div class=\"classify\">\r\n\r\n          <div class=\"box1\">\r\n            <label for=\"column\">专栏分类</label>\r\n            <el-button  v-if=\"popboxes\" class=\"m-2\" @click = \"dialogFormVisible = true\">选择分享专栏</el-button>\r\n            <el-button v-else class=\"m-2\" @click = \"dialogFormVisible = true\">{{ columnName }}</el-button>\r\n            <div v-if=\"dialogFormVisible\">\r\n                <CfDialog  v-model=\"dialogFormVisible\" @updateValue=\"handleUpdateValue\" ClassifyName=\"分享专栏\"></CfDialog>\r\n            </div>\r\n          </div>\r\n\r\n\r\n          <div class=\"box1\">\r\n            <span class=\"tclass\">权限设置</span>\r\n            <div class=\"my-2 flex items-center text-sm\">\r\n              <el-radio-group v-model=\"radio1\" class=\"radio_share\">\r\n                <el-radio label=\"0\">公开<span class=\"ptext\">(所有人公开)</span></el-radio>\r\n                <el-radio label=\"1\">私密<span class=\"ptext\">(仅自己可见)</span></el-radio>\r\n              </el-radio-group>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"button\">\r\n          <!-- <button class=\"bottom_btn\">取消</button>\r\n          <button class=\"bottom_btn\">保存草稿</button> -->\r\n          <button class=\"put\"  @click=\"submitToAPI\">发布</button>    \r\n        </div>\r\n      </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport axios from '@/utils/request';\r\nimport CfDialog from '../../components/CfDialog.vue';\r\nimport { ElMessage } from 'element-plus';\r\nimport {compressImage} from '@/utils/fileService'\r\nimport { useRouter } from 'vue-router'\r\nimport { getSharePicturePermission } from '@/utils/cosService'; \r\n\r\nconst userId = localStorage.getItem(\"userId\");  // 或您想要的任何默认值\r\nconst username = localStorage.getItem(\"userName\");  // 或您想要的任何默认值\r\n\r\nconst radio1 = ref('0');\r\nconst text = ref('');\r\nconst textarea = ref('');\r\nconst fileInput = ref(null);\r\nconst tags = ref([]);// 获取推荐标签\r\nconst selectedTags = ref([]);\r\nconst dialogFormVisible = ref(false);//控制cfdialog弹窗（显示文章专栏列表）是否弹出\r\nconst popboxes =ref(true);//控制文章分类专栏这个按键的显示值\r\nconst columnId = ref();\r\nconst columnName = ref();\r\nconst router = useRouter();\r\n\r\nconst imagePreviews = ref([]);\r\nconst selectedImages = ref([]);\r\nconst fileName = ref([]);\r\nconst number = ref(0);\r\n\r\n// 当点击按钮时触发文件输入框\r\nconst triggerImageUpload = () => {\r\n  if (selectedImages.value.length < 18) {\r\n    fileInput.value.click();\r\n  } else {\r\n    alert(\"只能提交三张照片\"); // 提示用户\r\n  }\r\n};\r\n\r\n// // 当文件选择后处理图片\r\n// const handleImage = (event) => {\r\n//   const file = event.target.files[0];\r\n//   if (file && selectedImages.value.length < 18) {\r\n//     const reader = new FileReader();\r\n//     reader.onload = function(e) {\r\n//       const compressedFile = compressImage(file);\r\n//       imagePreviews.value.push(e.target.result);  // 添加DataURL到imagePreviews\r\n//       selectedImages.value.push(compressedFile);  // 添加文件对象到selectedImages\r\n//     };\r\n//     reader.readAsDataURL(file);\r\n//   }\r\n// };\r\n\r\n\r\n//  (上传图片)当文件选择后处理图片\r\nconst handleImage = async (event) => {\r\n  const files = event.target.files;\r\n  for (const file of files) {\r\n    if (selectedImages.value.length < 18) {\r\n      try {\r\n        const timestamp = new Date().getTime(); // 获取当前时间戳\r\n        const compressedFile = await compressImage(file);\r\n        const reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          fileName.value.push(`${timestamp}-${file.name}`);\r\n          imagePreviews.value.push(e.target.result);\r\n          selectedImages.value.push(compressedFile);\r\n        };\r\n        reader.readAsDataURL(compressedFile);\r\n        number.value++;\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n//删除图片\r\nconst removeImage = (index) => {\r\n    selectedImages.value.splice(index, 1);\r\n    imagePreviews.value.splice(index, 1);  // 也删除对应的预览\r\n    number.value--;\r\n};\r\n\r\n// 从一个数组中随机选择n个元素\r\nconst randomSelect = (arr, n) => {\r\n    let shuffled = arr.slice();\r\n    for (let i = arr.length - 1; i > 0; i--) {\r\n        const j = Math.floor(Math.random() * (i + 1));\r\n        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\r\n    }\r\n    return shuffled.slice(0, n);\r\n};\r\n\r\n//获取标签接口\r\nconst fetchTags = async () => {\r\n    try {\r\n      const response = await axios.get('/sharelabel');\r\n      if (response.data.data && Array.isArray(response.data.data) && response.data.code ===1) {\r\n          const allTags = response.data.data.map(item => item.name);\r\n          tags.value = randomSelect(allTags, 6); // 随机选择标签\r\n      }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n      }\r\n    } catch (error) {\r\n        console.error('查找标签失败', error.message);\r\n        ElMessage.error('查找标签失败');\r\n    }\r\n};\r\n\r\n// 从提供的标签中选择标签\r\nconst addLabel = (tag) => {\r\n    if (selectedTags.value.length >= 4) {\r\n        alert(\"最多只能添加4个标签\");\r\n        return;\r\n    }\r\n    // 防止重复添加\r\n    if (!selectedTags.value.includes(tag)) {\r\n        selectedTags.value.push(tag);\r\n    }\r\n};\r\n\r\n//自定义新增标签\r\nconst newTag = ref(''); // 用于绑定到输入框的新标签名\r\nconst addNewTag = () => {\r\n    if (selectedTags.value.length >= 4) {\r\n        alert(\"最多只能添加4个标签\");\r\n        return;\r\n    }\r\n    if (newTag.value && !selectedTags.value.includes(newTag.value)) {\r\n        selectedTags.value.push(newTag.value);\r\n        addLabelToMysql(newTag.value);\r\n        newTag.value = '';  // 清空输入框\r\n    }\r\n};\r\n\r\n//删除函数\r\nconst removeTag = (tagToRemove) => {\r\n    const index = selectedTags.value.indexOf(tagToRemove);\r\n    if (index > -1) {\r\n        selectedTags.value.splice(index, 1);\r\n    }\r\n};\r\n\r\n//接受cfdialog返回的数据，从而确定专栏Id\r\nconst handleUpdateValue = (data) => {\r\n  columnId.value = data[0];\r\n  columnName.value = data[1];\r\n  popboxes.value = false;\r\n}\r\n\r\n//添加标签接口\r\nasync function addLabelToMysql(name) {\r\n  try {\r\n    const response = await axios.post('/sharelabel',{\r\n      name:name,\r\n      createId:userId,\r\n      createUsername:username,\r\n      type:0,\r\n    });\r\n    if (response.data.code === 1) {\r\n      ElMessage.success('添加标签成功')\r\n    }else{\r\n        console.error(\"添加标签失败\");\r\n        ElMessage.error(\"添加标签失败\");\r\n    }\r\n  } catch (error) {\r\n      console.error('添加标签失败', error);\r\n      ElMessage.error(\"添加标签失败\");\r\n  }\r\n}\r\n\r\n//将分享添加到专栏接口\r\nasync function uploadColumn(id) {\r\n  const response = await axios.post('/column/share', {\r\n    columnId:columnId.value,\r\n    contentId:id,\r\n  });\r\n  if(response.data.code ===1){\r\n    // ElMessage.success('添加专栏成功');\r\n  }\r\n  else if(response.data.code === 0 && response.data.msg){\r\n      ElMessage.error(response.data.msg.toString());\r\n  }else ElMessage.error('添加专栏失败');\r\n}\r\n\r\n\r\n// 发表分享的函数\r\nconst submitToAPI = async () => {\r\n    const url = '/share';\r\n    const payload = {\r\n        userId: userId,  // 默认值需要设置\r\n        username: username,  // 默认值需要设置\r\n        title: text.value,\r\n        content: textarea.value,\r\n        label: selectedTags.value.join(', '),\r\n        access: parseInt(radio1.value, 10)\r\n    };\r\n    try {\r\n        const response = await axios.post(url, payload);\r\n        if ( response.data.code === 1) {\r\n          ElMessage.success('发布分享成功');\r\n          const responseData = response.data.data;\r\n          await uploadColumn(responseData);//将分享添加到专栏接口\r\n          await getSharePicturePermission(selectedImages.value,fileName.value,number.value,responseData);\r\n          // router.push('/CreateCenter')\r\n        } else {\r\n          console.error('发布分享失败', response.data.msg);\r\n          ElMessage.error('发布分享失败');\r\n        }\r\n    } catch (error) {\r\n      console.error('发布分享失败', error);\r\n      ElMessage.error('发布分享失败');\r\n    }\r\n}\r\n\r\nonMounted(fetchTags);\r\n\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.large_body{\r\n  width: 100%;\r\n  background: #FDFBF6;;\r\n}\r\n.body {\r\n  display: flex;\r\n  justify-content: center;\r\n  width: 1020px;\r\n  background-color: #fff;\r\n  border-radius: 16px;\r\n  box-shadow: 0px 4px 4px 0px rgba(0, 0, 0, 0.25);\r\n  padding: 50px 55px;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  gap: 32px;\r\n  margin: 40px auto 0px;\r\n}\r\n\r\n.text{\r\n  align-self: stretch;\r\n  color: #000;\r\n  font-family: Microsoft YaHei;\r\n  font-size: 30px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: normal;\r\n}\r\n.show{\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n  gap: 45px;\r\n  align-self: stretch;\r\n}\r\n.picbox{\r\n  display: flex;\r\n  gap: 20px;\r\n  width: 100%;\r\n}\r\n.spic{\r\n  background-size: cover;\r\n  background-repeat: no-repeat;\r\n  background-position: center center;\r\n  border: 1px dashed #bbbbbb;\r\n  border-radius: 10px;\r\n  width: 180px;\r\n  height: 180px;\r\n}\r\n.picshow{\r\n  width: 180px;\r\n  height: 180px;\r\n  border: 1px dashed #bbbbbb;\r\n  border-radius: 10px;\r\n  position: relative;\r\n}\r\n.pic_contain{\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  width: 800px;\r\n  gap: 10px 15px;\r\n}\r\n.pictext{\r\n  width: 60px;\r\n  color: #606266;\r\n  font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;\r\n  font-size: 18px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: normal;\r\n}\r\n.ptitie {\r\n  height: 32px;\r\n  width: 900px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 30px;\r\n  align-self: stretch;\r\n}\r\n.mainp{\r\n  width: 900px;\r\n  display: flex;\r\n  align-items: flex-start;\r\n  gap: 30px;\r\n  align-self: stretch;\r\n}\r\n.mlable{\r\n  width: 900px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  gap: 15px;\r\n  align-self: stretch;\r\n}\r\n.lable{\r\n  display: flex;\r\n  align-items: flex-start; \r\n  gap: 30px; \r\n  width: 100%;\r\n}\r\n.rlable{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  height: 28px;\r\n  width: 110%;\r\n}\r\n.border-container{\r\n  border: 1px solid #dcdfe6;\r\n  display: inline-block;\r\n  height: 40px;\r\n  width: 100%;\r\n  padding: 5px;\r\n  border-radius: 5px;\r\n}\r\n.buttons-container {\r\n  display: flex; \r\n  align-items: center;\r\n  gap: 24px;         \r\n}\r\n.labletext{\r\n  margin-left: 72px;\r\n  color: #545454;\r\n  font-family: Microsoft YaHei;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: normal;\r\n}\r\n/* 标签输入框 */\r\n.custom-input-size {\r\n    width: 170px; \r\n    height: 17px;\r\n    padding: 6px 10px;\r\n    border-radius: 5px;\r\n    border: none;\r\n    margin-left: -6px;\r\n}\r\n input.custom-input-size:focus {\r\n  outline: none;\r\n  box-shadow: 0 2px 6px #cfd7e2;\r\n  border: 1px solid #d7d7d7;\r\n}\r\n.custom-input-size{\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  border: 1px solid #efefef;\r\n}\r\n/* 紫色标签样式 */\r\n.tag-btn {\r\n  display: flex;\r\n  align-items: center; \r\n  color: #000;\r\n  height: 28px;\r\n  cursor: pointer;\r\n  border: 1px solid #DCDFE6;\r\n  border-radius: 10px;\r\n  background: #9FA9CA;\r\n  padding: 4px 12px 4px 14px;\r\n}\r\n.buttons-container span{\r\n    display: flex;\r\n    height: 18px;\r\n    color:#000;\r\n    background-color: #9FA9CA;\r\n    border-radius: 10px;\r\n    font-size: 14px;\r\n    font-family: Microsoft YaHei;\r\n    cursor: pointer;\r\n    user-select: none;\r\n}\r\ni.delete-btn2 {\r\n    display: none;\r\n    margin-left: 1px;\r\n    font-size: 16px;\r\n}\r\n.tag-btn:hover {\r\n    padding: 4px 8px;\r\n    background: #CCD3E8; \r\n  }\r\n.tag-btn:hover i.delete-btn2 {\r\n  display: inline-block;\r\n}\r\n.text2{\r\n  color: #000;\r\n  font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;\r\n  font-size: 30px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: normal;\r\n  align-self: stretch;\r\n}\r\n.classify{\r\n  /* height: 103px; */\r\n  width: 780px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n  gap: 35px;\r\n}\r\n.box1{\r\n  display: flex;\r\n  width: 780px;\r\n  height: 24px;\r\n  align-items: center;\r\n  gap: 40px;\r\n}\r\n.tclass{\r\n  color: #606266;\r\n  font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;\r\n  font-size: 18px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: normal;\r\n}\r\n::v-deep .el-radio__label{\r\n    width: 100px;\r\n}\r\n::v-deep .radio_share span .ptext{\r\n  font-size: 12px;\r\n  margin-left: 4px;\r\n  letter-spacing: 0.5px;\r\n}\r\n.radio_share span{\r\n  display: inline-block;\r\n  width: 12px;\r\n  height: 12px;\r\n  font-size: 14px;\r\n  text-align: center;\r\n}\r\n.button{\r\n  height: 820px;\r\n  height: 35px;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n  gap: 16px;\r\n  align-self: stretch;\r\n}\r\n.put{\r\n  display: flex;\r\n  width: 60px;\r\n  padding: 5px 12px 6px 12px;\r\n  justify-content: center;\r\n  align-items: center;\r\n  border-radius: 8px;\r\n  background: #9FA9CA;\r\n  cursor: pointer;\r\n}\r\n.delete-btn {\r\n    position: absolute;\r\n    top: 5px;\r\n    right:8px;\r\n    cursor: pointer;\r\n}\r\n\r\n.spic, .tag-btn {\r\n    position: relative; \r\n}\r\n/* 底部按钮样式 */\r\n.bottom_btn {\r\n    display: inline-block;\r\n    text-align: center;\r\n    border-radius: 10px;\r\n    height: 32px;\r\n    padding: 8px 12px; \r\n    line-height: 16px; /*  使文本垂直居中*/\r\n    background-color: white;\r\n    border: 1px solid #DCDFE6;\r\n    color: #545454;\r\n    cursor: pointer; \r\n}\r\n.bottom_btn:hover, \r\n.bottom_btn:active {\r\n    background-color: #F7F7F7;\r\n}\r\n\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}