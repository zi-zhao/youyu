{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport TheHeader from '@/page/components/TheHeader.vue';\nimport YyButton from \"@/page/components/YyButton.vue\";\nimport { Search } from '@element-plus/icons-vue';\nimport { useRouter } from 'vue-router';\nimport { ElMessage } from 'element-plus';\nimport axios from '@/utils/request';\nimport { getUsersAvatarFromCOS } from '@/utils/cosService';\nimport { PageTitle } from '@/utils/fileService.js';\nexport default {\n  __name: 'PurchasedCourse',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const setPageTitle = PageTitle('正在加载...');\n    const router = useRouter();\n    const userId = localStorage.getItem(\"userId\"); // 获取用户ID\n    const userName = localStorage.getItem(\"userName\"); // 获取用户名\n    const userInfo = ref({});\n    const courseList = ref([]);\n    const count = ref();\n    setPageTitle(`${userName} 的已购课程 - 云联知渔`);\n\n    // 点击跳转至课程详情\n    const goToCourseDetail = courseId => {\n      router.push(`CourseDeatil/${courseId}`);\n    };\n\n    // 获取用户已购买课程的信息\n    const fetchUserPaperVideo = async () => {\n      try {\n        const response = await axios.get(`/paper/video/user/list`, {\n          params: {\n            page: 1,\n            pageSize: 100\n          }\n        });\n        if (response.data.code === 1) {\n          courseList.value = response.data.data.records;\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          ElMessage.error('获取用户已购买课程的信息失败');\n        }\n      } catch (error) {\n        console.error(\"获取用户已购买课程的信息失败\", error);\n        ElMessage.error('获取用户已购买课程的信息失败');\n      }\n    };\n\n    // 获取用户信息\n    const fetchUserInformation = async userId => {\n      try {\n        const response = await axios.get(`/users/${userId}`);\n        if (response.data.code === 1) {\n          userInfo.value = response.data.data;\n          userInfo.value.newAvatar = await getUsersAvatarFromCOS(userId);\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          ElMessage.error('获取用户信息失败');\n        }\n      } catch (error) {\n        console.error(\"获取用户信息失败\", error);\n        ElMessage.error('获取用户信息失败');\n      }\n    };\n\n    // 获取用户购买视频的个数信息\n    const fetchVideoCount = async () => {\n      try {\n        const response = await axios.get(`/paper/video/count`);\n        if (response.data.code === 1) {\n          count.value = response.data.data;\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          ElMessage.error('获取用户购买视频的个数失败');\n        }\n      } catch (error) {\n        console.error(\"获取用户购买视频的个数失败\", error);\n        ElMessage.error('获取用户购买视频的个数失败');\n      }\n    };\n    onMounted(() => {\n      fetchUserPaperVideo();\n      fetchUserInformation(userId);\n      fetchVideoCount();\n    });\n    const __returned__ = {\n      setPageTitle,\n      router,\n      userId,\n      userName,\n      userInfo,\n      courseList,\n      count,\n      goToCourseDetail,\n      fetchUserPaperVideo,\n      fetchUserInformation,\n      fetchVideoCount,\n      ref,\n      onMounted,\n      TheHeader,\n      YyButton,\n      get Search() {\n        return Search;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get axios() {\n        return axios;\n      },\n      get getUsersAvatarFromCOS() {\n        return getUsersAvatarFromCOS;\n      },\n      get PageTitle() {\n        return PageTitle;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","TheHeader","YyButton","Search","useRouter","ElMessage","axios","getUsersAvatarFromCOS","PageTitle","setPageTitle","router","userId","localStorage","getItem","userName","userInfo","courseList","count","goToCourseDetail","courseId","push","fetchUserPaperVideo","response","get","params","page","pageSize","data","code","value","records","msg","error","toString","console","fetchUserInformation","newAvatar","fetchVideoCount"],"sources":["D:/有渔/前端源码/YouyuBBS-Q - 副本/youyu-lyn-qtnew-vision-new-2024.1.14/src/page/TheVideo/PurchasedCourse.vue"],"sourcesContent":["<template>\r\n    <TheHeader></TheHeader>\r\n    <div class=\"large-box\">\r\n        <!-- 个人信息 -->\r\n        <div class=\"user-info\">\r\n            <img class=\"personal_bgc\" src=\"@/assets/PersonalPage/PersonalBackground.jpg\" alt=\"\">\r\n            <div class=\"user\">\r\n                <img :src=\"userInfo.newAvatar\" alt=\"User Avatar\" class=\"pic\" />\r\n                <div class=\"usershow\">\r\n                    <div style=\"display: flex;align-items: center;gap: 3px;\">\r\n                        <span class=\"name\">{{ userInfo.username }}</span>\r\n                        <img v-if=\"userInfo.verified === 1\"  src=\"@/assets/VerifiedUser.svg\" style=\"width: 16px;height: 16px;\" alt=\"\">\r\n                    </div>\r\n                    <div class=\"education\">\r\n                        <img src=\"@/assets/QACenter/EducationHat.svg\" alt=\"\">\r\n                        <span class=\"utext\">{{ userInfo.school }}</span>\r\n                        <span class=\"utext\">{{ userInfo.major }}</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!-- 课程列表 -->\r\n        <div class=\"course\">\r\n            <!-- 学校和专业选择 -->\r\n            <div class=\"line-title\">\r\n                <div class=\"major-box\">\r\n                    <span class=\"select-major\">已购课程<span style=\"margin-left: 5px;font-weight: 700;\">{{ count }}</span></span>\r\n                </div>\r\n            </div>\r\n            <!-- 课程 -->\r\n            <div class=\"course-list\">\r\n                <div v-for=\"course in courseList\" :key=\"course.id\" class=\"co-box\" @click=\"goToCourseDetail(course.id)\">\r\n                    <img :src=\"course.coverPicture\" alt=\"\" class=\"coverage\">         \r\n                    <div class=\"intro\">\r\n                        <span class=\"title multi-line-ellipsis-1\">{{ course.title }}</span>\r\n                        <span class=\"intro-text multi-line-ellipsis-3\">{{ course.description }}</span>\r\n                        <div style=\"width: 100%;display:flex;justify-content: space-between;\">\r\n                            <span class=\"price\">￥{{ course.price }}</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <el-empty \r\n                    v-if=\"!courseList || courseList.length === 0\" \r\n                    :image-size=\"200\" \r\n                    description=\"您还没有购买的课程呢，快去看看上新好课吧！\"\r\n                    style=\"margin: 0 auto;\"\r\n                />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref,onMounted } from 'vue'\r\nimport TheHeader from '@/page/components/TheHeader.vue';\r\nimport YyButton from \"@/page/components/YyButton.vue\";\r\nimport { Search } from '@element-plus/icons-vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { ElMessage } from 'element-plus';\r\nimport axios from '@/utils/request';\r\nimport { getUsersAvatarFromCOS } from '@/utils/cosService';\r\nimport { PageTitle } from '@/utils/fileService.js'\r\n\r\nconst setPageTitle = PageTitle('正在加载...');\r\nconst router = useRouter();\r\nconst userId = localStorage.getItem(\"userId\"); // 获取用户ID\r\nconst userName = localStorage.getItem(\"userName\"); // 获取用户名\r\nconst userInfo = ref({});\r\nconst courseList = ref([]);\r\nconst count = ref();\r\n\r\nsetPageTitle(`${ userName } 的已购课程 - 云联知渔`); \r\n\r\n// 点击跳转至课程详情\r\nconst goToCourseDetail = (courseId) =>{\r\n    router.push(`CourseDeatil/${courseId}`)\r\n}\r\n\r\n// 获取用户已购买课程的信息\r\nconst fetchUserPaperVideo = async () => {\r\n    try {\r\n        const response = await axios.get(`/paper/video/user/list`,{\r\n            params: {\r\n                page:1,\r\n                pageSize:100,\r\n            }\r\n        });\r\n        if(response.data.code === 1){\r\n            courseList.value = response.data.data.records;\r\n        }else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else{\r\n            ElMessage.error('获取用户已购买课程的信息失败');\r\n        }\r\n    } catch (error) {\r\n        console.error(\"获取用户已购买课程的信息失败\", error);\r\n        ElMessage.error('获取用户已购买课程的信息失败');\r\n    }\r\n};\r\n\r\n// 获取用户信息\r\nconst fetchUserInformation = async (userId) => {\r\n    try {\r\n        const response = await axios.get(`/users/${userId}`);\r\n        if(response.data.code === 1){\r\n            userInfo.value = response.data.data;\r\n            userInfo.value.newAvatar = await getUsersAvatarFromCOS(userId);\r\n        }else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else{\r\n            ElMessage.error('获取用户信息失败');\r\n        }\r\n    } catch (error) {\r\n        console.error(\"获取用户信息失败\", error);\r\n        ElMessage.error('获取用户信息失败');\r\n    }\r\n};\r\n\r\n// 获取用户购买视频的个数信息\r\nconst fetchVideoCount = async () => {\r\n    try {\r\n        const response = await axios.get(`/paper/video/count`);\r\n        if(response.data.code === 1){\r\n            count.value = response.data.data;\r\n        }else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else{\r\n            ElMessage.error('获取用户购买视频的个数失败');\r\n        }\r\n    } catch (error) {\r\n        console.error(\"获取用户购买视频的个数失败\", error);\r\n        ElMessage.error('获取用户购买视频的个数失败');\r\n    }\r\n};\r\n\r\n\r\nonMounted(() => {\r\n    fetchUserPaperVideo();\r\n    fetchUserInformation(userId);\r\n    fetchVideoCount();\r\n})\r\n\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.large-box {\r\n    width: 1200px;\r\n    margin: 2.5rem auto;\r\n    background-size: cover;\r\n    background-position: center;\r\n    background-repeat: no-repeat; \r\n}\r\n.user-info{\r\n    width: 100%;\r\n}\r\n.personal_bgc{\r\n    width: 100%;\r\n    height: 260px;;\r\n}\r\n.user {\r\n    margin-top: -7rem;\r\n    padding-left: 5rem;\r\n    gap: 2rem;\r\n    height: 170px;\r\n    display: flex;\r\n    align-items: flex-end;\r\n}\r\n.pic {\r\n    width: 10rem;\r\n    height: 10rem;\r\n    border-radius: 8px;\r\n    margin-bottom: 1rem;\r\n    border: 0.2rem solid #fff;\r\n}\r\n.usershow {\r\n    display: flex;\r\n    align-items: flex-end;\r\n    gap: 1rem;\r\n}\r\n.name {\r\n    color: #000;\r\n    text-align: center;\r\n    font-size: 22px;\r\n    white-space: nowrap;\r\n    font-weight: 700;\r\n}\r\n.education{\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.5rem;\r\n}\r\n.utext {\r\n    color: #000;\r\n    font-size: 14px;\r\n}\r\n.course{\r\n    width: 100%;\r\n    margin-top: 2rem;\r\n}\r\n.line-title{\r\n    width: 100%;\r\n    padding: 1rem 0;\r\n    justify-content: space-between;\r\n    display: flex;\r\n}\r\n.major-box{\r\n    border-bottom: 1px solid #EEE;\r\n    padding: 0 0 calc(1rem + 1px);\r\n    width: 100%;\r\n    height: 1.5rem;\r\n    overflow-x: auto;\r\n    overflow-y: hidden;\r\n    white-space: nowrap;\r\n    scrollbar-width: thin; /* 对于 Firefox */\r\n    scrollbar-color: #EEE transparent; /* 对于 Firefox，设置滚动条颜色和背景 */\r\n\r\n    /* 对于基于 WebKit 的浏览器 */\r\n    &::-webkit-scrollbar {\r\n        height: 1px; /* 设置滚动条高度 */\r\n    }\r\n    &::-webkit-scrollbar-track {\r\n        background: transparent; /* 设置滚动条轨道背景颜色 */\r\n        background-color: #EEE;\r\n    }\r\n    &::-webkit-scrollbar-thumb {\r\n        background-color: #EEE; /* 设置滚动条颜色 */\r\n    }\r\n}\r\n.select-major{\r\n    margin-left: 2rem;\r\n    display: inline-flex;\r\n    height: 1.5rem;\r\n    padding: 0 0 1rem;\r\n    color: #00A6DA;\r\n    border-bottom: 1px solid #00A6DA;\r\n    cursor: pointer;\r\n}\r\n.course-list{\r\n    width: 100%;\r\n    display: flex;\r\n    gap: 2rem calc((100% - 10px - 90%)/4);\r\n    flex-wrap: wrap;\r\n    margin-top: 2rem;\r\n}\r\n.co-box{\r\n    border-radius: 0.3rem;\r\n    border: 1px solid #e9e9e9;\r\n    width: 18%;\r\n    height: 290px;\r\n    cursor: pointer;\r\n}\r\n.coverage{\r\n    width: 100%;\r\n    border-radius: 0.3rem 0.3rem 0 0;\r\n    height: 45%;\r\n    border-bottom: 1px solid #e9e9e9;\r\n}\r\n.title{\r\n    font-weight: 700;\r\n}\r\n.intro{\r\n    width: 88%;\r\n    height: calc(100% - 45% - 2rem);\r\n    padding: 1rem 6%;\r\n    gap: 0.5rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n}\r\n.intro-text{\r\n    font-size: 0.8rem;\r\n    color: #706969;\r\n    line-height: 1.4;\r\n    height: 42%;\r\n}\r\n.price{\r\n    font-size: 0.8rem;\r\n    color: #FFC960;\r\n}\r\n@media (max-width:768px){\r\n    .large-box{\r\n        width: 100%;\r\n    }\r\n    .personal_bgc{\r\n        height: 190px;\r\n    }\r\n    .user{\r\n        margin-top: -3.5rem;\r\n        padding-left: 4%;\r\n        gap: 1rem;\r\n        height: auto;\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n    }\r\n    .pic{\r\n        width: 4rem;\r\n        height: 4rem;\r\n        border-radius: 8px;\r\n        margin-bottom: 0rem;\r\n        border: 0.1rem solid #fff;\r\n    }\r\n    .usershow{\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        gap: 0.5rem;\r\n    }\r\n    .name{\r\n        font-size: 1rem;\r\n    }\r\n    .course{\r\n        margin-top: 1rem;\r\n    }\r\n    .select-major{\r\n        margin-left: 6%;\r\n    }\r\n    .course-list{\r\n        gap: 2rem 3rem;\r\n        margin-top: 0rem;\r\n        justify-content: center;\r\n    }\r\n    .co-box{\r\n        width: 255px;\r\n        height: 300px;\r\n    }\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}