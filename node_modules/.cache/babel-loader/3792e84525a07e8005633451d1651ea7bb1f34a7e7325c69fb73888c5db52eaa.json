{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-7c59f31c\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"out\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \"手机号\", -1 /* HOISTED */));\nconst _hoisted_4 = {\n  class: \"out\"\n};\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \"身份验证\", -1 /* HOISTED */));\nconst _hoisted_6 = {\n  class: \"input-bx\"\n};\nconst _hoisted_7 = {\n  class: \"out\"\n};\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \"新密码\", -1 /* HOISTED */));\nconst _hoisted_9 = {\n  class: \"input-bx\"\n};\nconst _hoisted_10 = {\n  class: \"out\"\n};\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \"确认密码\", -1 /* HOISTED */));\nconst _hoisted_12 = {\n  class: \"input-bx\"\n};\nconst _hoisted_13 = {\n  class: \"footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createVNode(_component_el_input, {\n    modelValue: $setup.phone,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.phone = $event),\n    placeholder: \"请输入手机号\"\n  }, null, 8 /* PROPS */, [\"modelValue\"])]), _createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_el_input, {\n    modelValue: $setup.code,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.code = $event),\n    placeholder: \"请输入验证码\"\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _createVNode($setup[\"YyButton\"], {\n    theme: \"nobgc\",\n    class: \"verify\",\n    onClick: $setup.startCountdown,\n    disabled: !$setup.phone || $setup.isRunning\n  }, {\n    default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.inner), 1 /* TEXT */)]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"disabled\"])])]), _createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_el_input, {\n    type: \"password\",\n    modelValue: $setup.password,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.password = $event),\n    \"show-password\": \"\",\n    placeholder: \"请输入新密码\"\n  }, null, 8 /* PROPS */, [\"modelValue\"])])]), _createElementVNode(\"div\", _hoisted_10, [_hoisted_11, _createElementVNode(\"div\", _hoisted_12, [_createVNode(_component_el_input, {\n    type: \"password\",\n    modelValue: $setup.passworded,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.passworded = $event),\n    \"show-password\": \"\",\n    placeholder: \"请确认密码\"\n  }, null, 8 /* PROPS */, [\"modelValue\"])])]), _createElementVNode(\"div\", _hoisted_13, [_createVNode($setup[\"YyButton\"], {\n    theme: \"purple\",\n    onClick: $setup.changePassword\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"确认\")]),\n    _: 1 /* STABLE */\n  }), _createVNode($setup[\"YyButton\"], {\n    theme: \"gray\"\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"取消\")]),\n    _: 1 /* STABLE */\n  })])]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_createVNode","_component_el_input","$setup","phone","$event","placeholder","_hoisted_4","_hoisted_5","_hoisted_6","code","theme","onClick","startCountdown","disabled","isRunning","inner","_hoisted_7","_hoisted_8","_hoisted_9","type","password","_hoisted_10","_hoisted_11","_hoisted_12","passworded","_hoisted_13","changePassword"],"sources":["D:\\有渔\\前端源码\\YouyuBBS-Q - 副本\\youyu-lyn-qtnew-vision-new-2024.1.14\\src\\page\\TheSettings\\SecuLog\\pwdChange.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"out\">\r\n      <div class=\"title\">手机号</div>\r\n      <el-input  v-model=\"phone\" placeholder=\"请输入手机号\"/>\r\n    </div>\r\n    <div class=\"out\">\r\n      <div class=\"title\">身份验证</div>\r\n      <div class=\"input-bx\">\r\n        <el-input  v-model=\"code\" placeholder=\"请输入验证码\"/>\r\n        <YyButton theme=\"nobgc\" class=\"verify\" @click=\"startCountdown\" :disabled=\"!phone || isRunning\">{{ inner }}</YyButton>\r\n      </div>\r\n    </div>\r\n    <div class=\"out\">\r\n      <div class=\"title\">新密码</div>\r\n      <div class=\"input-bx\">\r\n        <el-input  type=\"password\" v-model=\"password\" show-password placeholder=\"请输入新密码\"/>\r\n      </div>\r\n    </div>\r\n    <div class=\"out\">\r\n      <div class=\"title\">确认密码</div>\r\n      <div class=\"input-bx\">\r\n        <el-input type=\"password\" v-model=\"passworded\"  show-password  placeholder=\"请确认密码\"/>\r\n      </div>\r\n    </div>\r\n    <div class=\"footer\">\r\n      <YyButton theme=\"purple\" @click=\"changePassword\">确认</YyButton>\r\n      <YyButton theme=\"gray\">取消</YyButton>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport YyButton from \"@/page/components/YyButton.vue\";\r\nimport axios from '@/utils/request';\r\nimport { ElMessage} from 'element-plus';\r\nimport { ref } from 'vue';\r\n\r\nconst phone = ref();\r\nconst code = ref();\r\nconst password = ref();\r\nconst passworded = ref();\r\nconst time = ref(60);\r\nconst isRunning = ref(false);\r\nconst inner = ref('获取短信验证码');\r\n\r\nconst validate = () => {\r\n  if (!/^1[3-9]\\d{9}$/.test(phone.value)) {\r\n    ElMessage.error('手机号格式不正确');\r\n    return false;\r\n  }\r\n  if (!code.value) {\r\n    ElMessage.error('请输入验证码');\r\n    return false;\r\n  }\r\n  if (password.value.length < 6 || password.value.length > 15) {\r\n    ElMessage.error('密码必须是 6-15 个字符');\r\n    return false;\r\n  }\r\n  if (password.value !== passworded.value) {\r\n    ElMessage.error('两次输入的密码不一致');\r\n    return false;\r\n  }\r\n  return true;\r\n};\r\n\r\n// 点击发送验证码\r\nasync function startCountdown() {\r\n  time.value = 60; // 或者其他您需要的倒计时时间\r\n  isRunning.value = true;\r\n  sendPasswordSMSCodePhone();\r\n  inner.value = `${time.value}秒后重新获取`;\r\n  const timeId = setInterval(() => {\r\n    time.value--;\r\n    if (time.value === 0) {\r\n      clearInterval(timeId);\r\n      inner.value = '获取短信验证码';\r\n      isRunning.value = false;\r\n    } else {\r\n      inner.value = `${time.value}秒后重新获取`;\r\n    }\r\n  }, 1000);\r\n}\r\n\r\n\r\n//获取验证码的接口\r\nasync function sendPasswordSMSCodePhone(){\r\n  try {\r\n    const response = await axios.get(`/sendPasswordSMSCode/${phone.value}`);\r\n    if(response.data.code === 1){\r\n      ElMessage.success('获取验证码成功');\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n      ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n      console.error(\"获取验证码失败\");\r\n      ElMessage.error('获取验证码失败');\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取验证码失败\", error); \r\n    ElMessage.error('获取验证码失败');\r\n  }\r\n}\r\n\r\n//修改密码的接口\r\nasync function changePassword(){\r\n  try {\r\n    if (!validate()) {\r\n      return;\r\n    }\r\n    const response = await axios.put('/users/changePassword',{\r\n      password:password.value,\r\n      code:code.value,\r\n    });\r\n    if(response.data.code === 1){\r\n      ElMessage.success('修改密码成功');\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n      ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n      console.error(\"修改密码失败\");\r\n      ElMessage.error('修改密码失败');\r\n    }\r\n  } catch (error) {\r\n    console.error(\"修改密码失败\", error); \r\n    ElMessage.error('修改密码失败');\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.container{\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 3rem;\r\n}\r\n.out{\r\n  display: flex;\r\n  gap: 5rem;\r\n}\r\n\r\n.title{\r\n  font-size: 16px;\r\n  width: 65px;\r\n  color: #7D7979;\r\n}\r\n\r\n.input-bx{\r\n  width: 400px;\r\n  display: flex;\r\n  height: 35px;\r\n  gap: 2rem;\r\n}\r\n\r\n.footer{\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 2rem;\r\n  margin: 0 auto;\r\n}\r\n\r\n.verify{\r\n  width: 210px;\r\n}\r\n</style>\r\n"],"mappings":";;;EACOA,KAAK,EAAC;AAAW;;EACfA,KAAK,EAAC;AAAK;gEACdC,mBAAA,CAA4B;EAAvBD,KAAK,EAAC;AAAO,GAAC,KAAG;;EAGnBA,KAAK,EAAC;AAAK;gEACdC,mBAAA,CAA6B;EAAxBD,KAAK,EAAC;AAAO,GAAC,MAAI;;EAClBA,KAAK,EAAC;AAAU;;EAKlBA,KAAK,EAAC;AAAK;gEACdC,mBAAA,CAA4B;EAAvBD,KAAK,EAAC;AAAO,GAAC,KAAG;;EACjBA,KAAK,EAAC;AAAU;;EAIlBA,KAAK,EAAC;AAAK;iEACdC,mBAAA,CAA6B;EAAxBD,KAAK,EAAC;AAAO,GAAC,MAAI;;EAClBA,KAAK,EAAC;AAAU;;EAIlBA,KAAK,EAAC;AAAQ;;;uBAxBrBE,mBAAA,CA4BM,OA5BNC,UA4BM,GA3BJF,mBAAA,CAGM,OAHNG,UAGM,GAFJC,UAA4B,EAC5BC,YAAA,CAAiDC,mBAAA;gBAA7BC,MAAA,CAAAC,KAAK;+DAALD,MAAA,CAAAC,KAAK,GAAAC,MAAA;IAAEC,WAAW,EAAC;6CAEzCV,mBAAA,CAMM,OANNW,UAMM,GALJC,UAA6B,EAC7BZ,mBAAA,CAGM,OAHNa,UAGM,GAFJR,YAAA,CAAgDC,mBAAA;gBAA5BC,MAAA,CAAAO,IAAI;+DAAJP,MAAA,CAAAO,IAAI,GAAAL,MAAA;IAAEC,WAAW,EAAC;2CACtCL,YAAA,CAAqHE,MAAA;IAA3GQ,KAAK,EAAC,OAAO;IAAChB,KAAK,EAAC,QAAQ;IAAEiB,OAAK,EAAET,MAAA,CAAAU,cAAc;IAAGC,QAAQ,GAAGX,MAAA,CAAAC,KAAK,IAAID,MAAA,CAAAY;;sBAAW,MAAW,C,kCAARZ,MAAA,CAAAa,KAAK,iB;;uCAG3GpB,mBAAA,CAKM,OALNqB,UAKM,GAJJC,UAA4B,EAC5BtB,mBAAA,CAEM,OAFNuB,UAEM,GADJlB,YAAA,CAAkFC,mBAAA;IAAvEkB,IAAI,EAAC,UAAU;gBAAUjB,MAAA,CAAAkB,QAAQ;+DAARlB,MAAA,CAAAkB,QAAQ,GAAAhB,MAAA;IAAE,eAAa,EAAb,EAAa;IAACC,WAAW,EAAC;+CAG5EV,mBAAA,CAKM,OALN0B,WAKM,GAJJC,WAA6B,EAC7B3B,mBAAA,CAEM,OAFN4B,WAEM,GADJvB,YAAA,CAAoFC,mBAAA;IAA1EkB,IAAI,EAAC,UAAU;gBAAUjB,MAAA,CAAAsB,UAAU;+DAAVtB,MAAA,CAAAsB,UAAU,GAAApB,MAAA;IAAG,eAAa,EAAb,EAAa;IAAEC,WAAW,EAAC;+CAG/EV,mBAAA,CAGM,OAHN8B,WAGM,GAFJzB,YAAA,CAA8DE,MAAA;IAApDQ,KAAK,EAAC,QAAQ;IAAEC,OAAK,EAAET,MAAA,CAAAwB;;sBAAgB,MAAE,C,iBAAF,IAAE,E;;MACnD1B,YAAA,CAAoCE,MAAA;IAA1BQ,KAAK,EAAC;EAAM;sBAAC,MAAE,C,iBAAF,IAAE,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}