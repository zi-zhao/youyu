{"ast":null,"code":"import { createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-367c111e\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"page\"\n};\nconst _hoisted_2 = {\n  class: \"outside\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"left\"\n}, \"上次登录时间\", -1 /* HOISTED */));\nconst _hoisted_4 = {\n  class: \"right\"\n};\nconst _hoisted_5 = {\n  class: \"outside\"\n};\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"left\"\n}, \"上次登录地点\", -1 /* HOISTED */));\nconst _hoisted_7 = {\n  class: \"right\"\n};\nconst _hoisted_8 = {\n  class: \"outside\"\n};\nconst _hoisted_9 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"left\"\n}, \"上次登录IP\", -1 /* HOISTED */));\nconst _hoisted_10 = {\n  class: \"right\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode($setup[\"TitleSection\"], {\n    message: $setup.msg,\n    \"show-btn\": false\n  }, null, 8 /* PROPS */, [\"message\"]), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"div\", _hoisted_4, _toDisplayString($setup.user.lastLoginTime), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _createElementVNode(\"div\", _hoisted_7, _toDisplayString($setup.user.lastLoginLocation), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_8, [_hoisted_9, _createElementVNode(\"div\", _hoisted_10, _toDisplayString($setup.user.lastLoginIp), 1 /* TEXT */)]), _createCommentVNode(\" <div class=\\\"text-foot\\\">\\r\\n      根据登录时间，IP，地理位置，若判断为异常情况，请在核实后及时\\r\\n      <span class=\\\"pwdchange\\\" @click=\\\"showPwdDialog = true\\\">修改密码</span>\\r\\n    </div> \"), _createVNode(_component_el_dialog, {\n    modelValue: $setup.showPwdDialog,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.showPwdDialog = $event),\n    width: \"70%\",\n    title: \"修改密码\",\n    onClose: _cache[1] || (_cache[1] = $event => $setup.showPwdDialog = false)\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"PwdChange\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _createVNode($setup[\"YyButton\"], {\n    theme: \"purple\",\n    style: {\n      \"margin-top\": \"3rem\",\n      \"padding\": \"0.5rem 1rem\"\n    },\n    onClick: $setup.exitLogFunction\n  }, {\n    default: _withCtx(() => [_createTextVNode(\" 退出登录\")]),\n    _: 1 /* STABLE */\n  })])]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_createVNode","$setup","message","msg","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","user","lastLoginTime","_hoisted_5","_hoisted_6","_hoisted_7","lastLoginLocation","_hoisted_8","_hoisted_9","_hoisted_10","lastLoginIp","_createCommentVNode","_component_el_dialog","showPwdDialog","$event","width","title","onClose","_cache","theme","style","onClick","exitLogFunction"],"sources":["D:\\有渔\\前端源码\\YouyuBBS-Q - 副本\\youyu-lyn-qtnew-vision-new-2024.1.14\\src\\page\\TheSettings\\SecuLog\\LogExit.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <TitleSection :message=\"msg\" :show-btn=\"false\"/>\r\n  <div class=\"page\">\r\n    <div class=\"outside\">\r\n      <div class=\"left\">上次登录时间</div>\r\n      <div class=\"right\">{{ user.lastLoginTime }}</div>\r\n    </div>\r\n\r\n    <div class=\"outside\">\r\n      <div class=\"left\">上次登录地点</div>\r\n      <div class=\"right\">{{ user.lastLoginLocation }}</div>\r\n    </div>\r\n\r\n    <div class=\"outside\">\r\n      <div class=\"left\">上次登录IP</div>\r\n      <div class=\"right\">{{ user.lastLoginIp }}</div>\r\n    </div>\r\n\r\n    <!-- <div class=\"text-foot\">\r\n      根据登录时间，IP，地理位置，若判断为异常情况，请在核实后及时\r\n      <span class=\"pwdchange\" @click=\"showPwdDialog = true\">修改密码</span>\r\n    </div> -->\r\n    <el-dialog v-model=\"showPwdDialog\" width=\"70%\" title=\"修改密码\" @close=\"showPwdDialog = false\">\r\n      <PwdChange />\r\n    </el-dialog>\r\n    <YyButton theme=\"purple\" style=\"margin-top: 3rem;padding: 0.5rem 1rem;\" @click=\"exitLogFunction\"> 退出登录</YyButton>\r\n  </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref,onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport TitleSection from \"@/page/TheSettings/components/TitleSection.vue\";\r\nimport YyButton from \"@/page/components/YyButton.vue\";\r\nimport PwdChange from \"@/page/TheSettings/SecuLog/pwdChange.vue\";\r\nimport axios from '@/utils/request';\r\nimport { ElMessage,ElMessageBox} from 'element-plus';\r\n\r\nconst userId = localStorage.getItem(\"userId\"); // 获取用户ID\r\nconst msg = ref('登录信息');\r\nconst router = useRouter();\r\nconst showPwdDialog = ref(false);\r\nconst user = ref({});\r\n\r\n//退出登录的弹框\r\nconst exitLogFunction = async () => {\r\n  try {\r\n    await ElMessageBox.confirm(\r\n      '确定要退出登录吗？',\r\n      {\r\n        confirmButtonText: '确认退出',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n      }\r\n    );\r\n    exitLog();\r\n  } catch {\r\n    console.log('关闭弹框')\r\n  }\r\n}\r\n\r\n//退出登录的接口\r\nasync function exitLog(){\r\n  // try {\r\n  //   const response = await axios.post('/user/logout');\r\n  //   if(response.data.code === 1){\r\n      localStorage.clear();\r\n      console.log('localStorage中的数据已被清理');\r\n      ElMessage.success('退出登录成功');\r\n      router.push('/');\r\n    // }else if(response.data.code === 0 && response.data.msg){\r\n    //   ElMessage.error(response.data.msg.toString());\r\n    // }else{\r\n    //   console.error(\"退出登录失败\");\r\n    //   ElMessage.error('退出登录失败');\r\n    // }\r\n  // } catch (error) {\r\n  //   console.error(\"退出登录失败\", error); \r\n  //   ElMessage.error('退出登录失败');\r\n  // }\r\n}\r\n\r\n// 获取用户信息\r\nconst fetchAvatar = async () => {\r\n  try {\r\n    const response = await axios.get(`/users/${userId}`);\r\n    if(response.data.code === 1){\r\n      user.value = response.data.data;\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n      ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n      ElMessage.error('获取用户信息失败');\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取用户信息失败\", error);\r\n    ElMessage.error('获取用户信息失败');\r\n  }\r\n};\r\n\r\n      \r\nonMounted(() => {\r\n  fetchAvatar();\r\n})\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.page{\r\n  margin-top: 5rem;\r\n  display: flex;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  gap: 3rem;\r\n  padding: 0 12rem;\r\n}\r\n:deep .page .el-dialog__body{\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n.outside{\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.left{\r\n  flex: 50%;\r\n  text-align: left;\r\n  color: #7D7979;\r\n}\r\n\r\n.right{\r\n  flex: 50%;\r\n  text-align: left;\r\n}\r\n\r\n.text-foot{\r\n  margin-top: 3rem;\r\n  text-align: left;\r\n  color: #7D7979;\r\n}\r\n\r\n.pwdchange{\r\n  color: #60A7F3;\r\n  cursor: pointer;\r\n}\r\n</style>"],"mappings":";;;EAGOA,KAAK,EAAC;AAAM;;EACVA,KAAK,EAAC;AAAS;gEAClBC,mBAAA,CAA8B;EAAzBD,KAAK,EAAC;AAAM,GAAC,QAAM;;EACnBA,KAAK,EAAC;AAAO;;EAGfA,KAAK,EAAC;AAAS;gEAClBC,mBAAA,CAA8B;EAAzBD,KAAK,EAAC;AAAM,GAAC,QAAM;;EACnBA,KAAK,EAAC;AAAO;;EAGfA,KAAK,EAAC;AAAS;gEAClBC,mBAAA,CAA8B;EAAzBD,KAAK,EAAC;AAAM,GAAC,QAAM;;EACnBA,KAAK,EAAC;AAAO;;;uBAftBE,mBAAA,CA2BM,cA1BJC,YAAA,CAAgDC,MAAA;IAAjCC,OAAO,EAAED,MAAA,CAAAE,GAAG;IAAG,UAAQ,EAAE;wCAC1CL,mBAAA,CAwBM,OAxBNM,UAwBM,GAvBJN,mBAAA,CAGM,OAHNO,UAGM,GAFJC,UAA8B,EAC9BR,mBAAA,CAAiD,OAAjDS,UAAiD,EAAAC,gBAAA,CAA3BP,MAAA,CAAAQ,IAAI,CAACC,aAAa,iB,GAG1CZ,mBAAA,CAGM,OAHNa,UAGM,GAFJC,UAA8B,EAC9Bd,mBAAA,CAAqD,OAArDe,UAAqD,EAAAL,gBAAA,CAA/BP,MAAA,CAAAQ,IAAI,CAACK,iBAAiB,iB,GAG9ChB,mBAAA,CAGM,OAHNiB,UAGM,GAFJC,UAA8B,EAC9BlB,mBAAA,CAA+C,OAA/CmB,WAA+C,EAAAT,gBAAA,CAAzBP,MAAA,CAAAQ,IAAI,CAACS,WAAW,iB,GAGxCC,mBAAA,qKAGU,EACVnB,YAAA,CAEYoB,oBAAA;gBAFQnB,MAAA,CAAAoB,aAAa;+DAAbpB,MAAA,CAAAoB,aAAa,GAAAC,MAAA;IAAEC,KAAK,EAAC,KAAK;IAACC,KAAK,EAAC,MAAM;IAAEC,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAJ,MAAA,IAAErB,MAAA,CAAAoB,aAAa;;sBAC/E,MAAa,CAAbrB,YAAA,CAAaC,MAAA,e;;qCAEfD,YAAA,CAAiHC,MAAA;IAAvG0B,KAAK,EAAC,QAAQ;IAACC,KAA8C,EAA9C;MAAA;MAAA;IAAA,CAA8C;IAAEC,OAAK,EAAE5B,MAAA,CAAA6B;;sBAAiB,MAAK,C,iBAAL,OAAK,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}