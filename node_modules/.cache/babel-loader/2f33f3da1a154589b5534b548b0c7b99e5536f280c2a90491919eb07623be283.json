{"ast":null,"code":"import { ref, onMounted, computed, watch, onUnmounted } from 'vue';\nimport { PageTitle } from '@/utils/fileService.js';\nimport TheHeader from '@/page/components/TheHeader.vue';\nimport VideoPlay from '@/page/components/VideoPlay.vue';\nimport { useRoute } from 'vue-router';\nimport { ElMessage } from 'element-plus';\nimport axios from '@/utils/request';\nimport { getVideoPaperFromCOS } from '@/utils/cosService';\nimport Vue3Qrcode from 'vue3-qrcode';\nimport YyButton from \"@/page/components/YyButton.vue\";\nimport { useRouter } from 'vue-router';\nimport { openUrl } from '@/utils/routeJudge';\nexport default {\n  __name: 'CourseDetail',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const codeUrl = ref();\n    const route = useRoute();\n    const courseId = parseInt(route.params.id, 10); //路径中的ID\n    const setPageTitle = PageTitle('正在加载...');\n    const selectedVideo = ref(); //用户所选视频的id\n    const agreementName = ref('有渔货币协议'); //支付弹框中必须阅读的协议\n    const videoList = ref([]);\n    const courseData = ref({});\n    const videoUrl = ref();\n    const showVideoPlayer = ref(true);\n    const dialogPayVisible = ref(false); //选择支付方式弹框\n    const dialogInputCodeVisible = ref(false); //输入兑换码弹框\n    const dialogWeiChatVisible = ref(false); //微信支付弹框\n    const courseCode = ref(''); //用户输入的兑换码\n    const videoPayState = ref(); //获取用户购买整套视频的状态\n    const orderId = ref();\n    const intervalId = ref(null); // 定义定时器 ID\n\n    //视频组件传值\n    const isLive = ref(false);\n    const poster = ref();\n    const autoplay = ref(false);\n    const sources = computed(() => [{\n      type: \"video/mp4\",\n      src: videoUrl.value\n    }]);\n    watch(videoUrl, (newValue, oldValue) => {\n      if (newValue !== oldValue) {\n        showVideoPlayer.value = false;\n        setTimeout(() => {\n          showVideoPlayer.value = true;\n        }, 400); // 1秒后重新渲染子组件\n      }\n    });\n\n    //处理毫秒数的函数\n    const formatDuration = milliseconds => {\n      let seconds = Math.floor(milliseconds / 1000);\n      let minutes = Math.floor(seconds / 60);\n      let hours = Math.floor(minutes / 60);\n      seconds = seconds % 60;\n      minutes = minutes % 60;\n      const paddedHours = hours.toString().padStart(2, '0');\n      const paddedMinutes = minutes.toString().padStart(2, '0');\n      const paddedSeconds = seconds.toString().padStart(2, '0');\n      return `${paddedHours}:${paddedMinutes}:${paddedSeconds}`;\n    };\n\n    // 点击打开输入兑换码弹框\n    const goToInputCode = () => {\n      dialogInputCodeVisible.value = true;\n      dialogPayVisible.value = false;\n    };\n\n    // 点击打开微信支付弹框\n    const goToWeiChatPay = () => {\n      dialogWeiChatVisible.value = true;\n      dialogPayVisible.value = false;\n      getPaperVideoCodeUrl();\n    };\n\n    // 跳转至货币协议\n    const goToCurrencyAgreement = () => {\n      // const routeLocation = router.resolve({ path: `/CurrencyAgreement` });\n      // window.open(routeLocation.href, '_blank');\n      openUrl(`/CurrencyAgreement`);\n    };\n\n    //点击选择视频\n    async function handleVideoClick(videoid) {\n      const status = await getPaperVideoClipPurchaseState(videoid);\n      selectedVideo.value = videoid;\n      if (status != 0) {\n        videoUrl.value = await getVideoPaperFromCOS(videoid);\n      } else {\n        dialogPayVisible.value = true;\n      }\n    }\n\n    //生成视频订单接口\n    async function getPaperVideoCodeUrl() {\n      try {\n        const queryParams = new URLSearchParams({\n          videoId: Number(courseId)\n        }).toString();\n        const response = await axios.post(`/wechat/paper?${queryParams}`);\n        if (response.data.code === 1) {\n          codeUrl.value = response.data.data.codeUrl;\n          orderId.value = response.data.data.orderId;\n          intervalId.value = setInterval(getWechatPaperVideoPurchaseState, 2500);\n          setTimeout(() => {\n            if (intervalId.value) {\n              clearInterval(intervalId.value);\n              intervalId.value = null;\n            }\n          }, 600000);\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"生成视频订单失败\");\n          ElMessage.error(\"生成视频订单失败\");\n        }\n      } catch (error) {\n        console.error(\"生成视频订单失败\", error);\n        ElMessage.error(\"生成视频订单失败\");\n      }\n    }\n\n    //查询视频订单状态状态接口\n    async function getWechatPaperVideoPurchaseState() {\n      try {\n        if (!dialogWeiChatVisible.value) {\n          clearInterval(intervalId.value);\n          return; // 退出函数\n        }\n        const response = await axios.get(`/wechat/paper/${orderId.value}`);\n        if (response.data.code === 1) {\n          if (response.data.data === 1) {\n            ElMessage.success(\"购买视频成功\");\n            setTimeout(() => {\n              window.location.reload();\n            }, 1000);\n          }\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"购买视频失败\");\n          ElMessage.error(\"购买视频失败\");\n        }\n      } catch (error) {\n        console.error(\"购买视频失败\", error);\n        ElMessage.error(\"购买视频失败\");\n      }\n    }\n\n    //用户用兑换码购买视频接口\n    async function getPaperVideoPurchaseByCdkey() {\n      try {\n        const response = await axios.get(`/paper/video/purchase/by/cdkey`, {\n          params: {\n            key: courseCode.value,\n            id: courseId\n          }\n        });\n        if (response.data.code === 1) {\n          ElMessage.success(\"兑换视频成功\");\n          setTimeout(() => {\n            window.location.reload();\n          }, 1000);\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"兑换视频失败\");\n          ElMessage.error(\"兑换视频失败\");\n        }\n      } catch (error) {\n        console.error(\"兑换视频失败\", error);\n        ElMessage.error(\"兑换视频失败\");\n      }\n    }\n\n    //获取用户购买视频的状态接口\n    async function getPaperVideoPurchaseState(courseId) {\n      try {\n        const response = await axios.get(`/paper/video/purchase/state/${courseId}`);\n        if (response.data.code === 1) {\n          videoPayState.value = response.data.data;\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"查询视频订单状态失败\");\n          ElMessage.error(\"查询视频订单状态失败\");\n        }\n      } catch (error) {\n        console.error(\"查询视频订单状态失败\", error);\n        ElMessage.error(\"查询视频订单状态失败\");\n      }\n    }\n\n    //获取用户购买视频切片的状态接口\n    async function getPaperVideoClipPurchaseState(id) {\n      try {\n        const response = await axios.get(`/paper/video/clip/purchase/state/${id}`);\n        if (response.data.code === 1) {\n          return response.data.data;\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"获取购买状态失败\");\n          ElMessage.error(\"获取购买状态失败\");\n        }\n      } catch (error) {\n        console.error(\"获取购买状态失败\", error);\n        ElMessage.error(\"获取购买状态失败\");\n      }\n    }\n\n    //根据id获取视频信息接口\n    async function getPaperVideoOptions() {\n      try {\n        const response = await axios.get(`/paper/video/${courseId}`);\n        if (response.data.code === 1) {\n          courseData.value = response.data.data;\n          setPageTitle(`${courseData.value.title}视频 - 云联知渔`);\n          poster.value = courseData.value.coverPicture;\n          courseData.value.price = courseData.value.price / 100;\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"获取视频信息数据失败\");\n          ElMessage.error(\"获取视频信息数据失败\");\n        }\n      } catch (error) {\n        console.error(\"获取视频信息数据失败\", error);\n        ElMessage.error(\"获取视频信息数据失败\");\n      }\n    }\n\n    //获取视频对应的切片数据接口\n    async function getPaperVideoClipOptions() {\n      try {\n        const response = await axios.get(`/paper/video/clip/list`, {\n          params: {\n            id: courseId,\n            page: 1,\n            pageSize: 100\n          }\n        });\n        if (response.data.code === 1) {\n          videoList.value = response.data.data.records;\n          for (let record of videoList.value) {\n            record.duration = formatDuration(record.duration);\n          }\n          videoUrl.value = await getVideoPaperFromCOS(response.data.data.records[0].id);\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"获取学科对应的视频数据失败\");\n          ElMessage.error(\"获取学科对应的视频数据失败\");\n        }\n      } catch (error) {\n        console.error(\"获取学科对应的视频数据失败\", error);\n        ElMessage.error(\"获取学科对应的视频数据失败\");\n      }\n    }\n    onMounted(() => {\n      getPaperVideoPurchaseState(courseId);\n      getPaperVideoOptions();\n      getPaperVideoClipOptions();\n    });\n    onUnmounted(() => {\n      // 组件卸载时清除定时器\n      if (intervalId.value) {\n        clearInterval(intervalId.value);\n      }\n    });\n    const __returned__ = {\n      router,\n      codeUrl,\n      route,\n      courseId,\n      setPageTitle,\n      selectedVideo,\n      agreementName,\n      videoList,\n      courseData,\n      videoUrl,\n      showVideoPlayer,\n      dialogPayVisible,\n      dialogInputCodeVisible,\n      dialogWeiChatVisible,\n      courseCode,\n      videoPayState,\n      orderId,\n      intervalId,\n      isLive,\n      poster,\n      autoplay,\n      sources,\n      formatDuration,\n      goToInputCode,\n      goToWeiChatPay,\n      goToCurrencyAgreement,\n      handleVideoClick,\n      getPaperVideoCodeUrl,\n      getWechatPaperVideoPurchaseState,\n      getPaperVideoPurchaseByCdkey,\n      getPaperVideoPurchaseState,\n      getPaperVideoClipPurchaseState,\n      getPaperVideoOptions,\n      getPaperVideoClipOptions,\n      ref,\n      onMounted,\n      computed,\n      watch,\n      onUnmounted,\n      get PageTitle() {\n        return PageTitle;\n      },\n      TheHeader,\n      VideoPlay,\n      get useRoute() {\n        return useRoute;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get axios() {\n        return axios;\n      },\n      get getVideoPaperFromCOS() {\n        return getVideoPaperFromCOS;\n      },\n      get Vue3Qrcode() {\n        return Vue3Qrcode;\n      },\n      YyButton,\n      get useRouter() {\n        return useRouter;\n      },\n      get openUrl() {\n        return openUrl;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","watch","onUnmounted","PageTitle","TheHeader","VideoPlay","useRoute","ElMessage","axios","getVideoPaperFromCOS","Vue3Qrcode","YyButton","useRouter","openUrl","router","codeUrl","route","courseId","parseInt","params","id","setPageTitle","selectedVideo","agreementName","videoList","courseData","videoUrl","showVideoPlayer","dialogPayVisible","dialogInputCodeVisible","dialogWeiChatVisible","courseCode","videoPayState","orderId","intervalId","isLive","poster","autoplay","sources","type","src","value","newValue","oldValue","setTimeout","formatDuration","milliseconds","seconds","Math","floor","minutes","hours","paddedHours","toString","padStart","paddedMinutes","paddedSeconds","goToInputCode","goToWeiChatPay","getPaperVideoCodeUrl","goToCurrencyAgreement","handleVideoClick","videoid","status","getPaperVideoClipPurchaseState","queryParams","URLSearchParams","videoId","Number","response","post","data","code","setInterval","getWechatPaperVideoPurchaseState","clearInterval","msg","error","console","get","success","window","location","reload","getPaperVideoPurchaseByCdkey","key","getPaperVideoPurchaseState","getPaperVideoOptions","title","coverPicture","price","getPaperVideoClipOptions","page","pageSize","records","record","duration"],"sources":["D:/有渔/前端源码/YouyuBBS-Q - 副本/youyu-lyn-qtnew-vision-new-2024.1.14/src/page/TheVideo/CourseDetail.vue"],"sourcesContent":["<template>\r\n    <TheHeader></TheHeader>\r\n    <div class=\"large-box\">\r\n        <!-- 左侧课程标题+视频播放+课程详情 -->\r\n        <div class=\"left\">\r\n            <!-- 课程标题+时间+购买人数 -->\r\n            <div class=\"left-top\">\r\n                <span class=\"title\">{{ courseData.title }}</span>\r\n                <div style=\"display:flex;align-items:center;justify-content: space-between;\">\r\n                    <span class=\"time\">\r\n                        {{ courseData.createTime }}\r\n                    </span>\r\n                    <span class=\"purperson-num\">\r\n                        {{ courseData.saleCount }}人购买\r\n                    </span>\r\n                    <span class=\"purperson-num\" v-if=\"videoPayState === 0\"  style=\"cursor: pointer;\" @click=\"dialogPayVisible = true\">\r\n                        点击购买\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <!-- 选择支付方式弹框 -->\r\n            <el-dialog v-model=\"dialogPayVisible\" :title=\"'购买' + courseData.title\" >\r\n                <div style=\"display: flex;flex-direction: column;align-items: center;justify-content: center;gap: 3rem;margin-top: 2rem;\">\r\n                    <div style=\"font-size: 18px;line-height: 1.6;font-weight: 700;\">请选择支付方式</div>\r\n                    <div style=\"display: flex;gap: 20px;\">\r\n                        <YyButton theme=\"purple\" style=\"padding: 6px 15px;\" @click=\"goToInputCode\">输入兑换码</YyButton>\r\n                        <YyButton theme=\"gray\" style=\"padding: 6px 15px;\" @click=\"goToWeiChatPay\">微信支付</YyButton>\r\n                    </div>\r\n                </div>\r\n            </el-dialog>\r\n            <!-- 输入兑换码弹框 -->\r\n            <el-dialog v-model=\"dialogInputCodeVisible\" :title=\"'购买' + courseData.title\" >\r\n                <div class=\"content\" style=\"flex-direction: column;align-items: center;position: relative;\">\r\n                    <div style=\"font-size: 18px;font-weight: 700;\">输入兑换码</div>\r\n                    <el-input v-model=\"courseCode\" placeholder=\"请输入课程兑换码\" style=\"width: 60%;\"></el-input>\r\n                    <YyButton theme=\"purple\" @click=\"getPaperVideoPurchaseByCdkey\" class=\"youyu-btn\">确定</YyButton>\r\n                </div>\r\n                <div style=\"display:flex;align-items:center;justify-content: center;position: absolute;bottom: 10px;left: calc((100% - 253px) / 2);\">\r\n                    <div class=\"read-text\">请注意：输入兑换码代表您已阅读并同意</div>\r\n                    <span class=\"agreement\" @click=\"goToCurrencyAgreement\">《{{ agreementName }}》</span>\r\n                </div>\r\n            </el-dialog>\r\n            <!-- 微信支付弹框 -->\r\n            <el-dialog v-model=\"dialogWeiChatVisible\" :title=\"'购买' + courseData.title\" class=\"weichat-dialog\" style=\"height: 52vh;\">\r\n                <div class=\"content\">\r\n                    <!-- 支付二维码 -->\r\n                    <div class=\"QRcode\">\r\n                        <vue3-qrcode :value=\"codeUrl\"></vue3-qrcode>\r\n                    </div>\r\n                    <div class=\"pay-info\">\r\n                        <div class=\"pay\">支付￥{{  courseData.price }}</div>\r\n                        <div class=\"pay-icon\">\r\n                            <img src=\"@/assets/TheVideo/WeiChat.png\" alt=\"\">\r\n                             <!-- <img src=\"@/assets/TheVideo/AliPay.jpg\" alt=\"\"> -->\r\n                        </div>\r\n                        <div class=\"read-text\">（暂时只支持微信支付）</div>\r\n                    </div>\r\n                </div>\r\n                <!-- 扫码后显示订单已创建 -->\r\n                <div class=\"notification-box\">\r\n                    <div class=\"checkmark-circle\">\r\n                        <!-- <div class=\"checkmark\"></div> -->\r\n                        <el-icon style=\"width: 1.5rem;height: 1.5rem;\"><Select/></el-icon>\r\n                    </div>\r\n                    <div class=\"notification-text\">\r\n                        您已创建订单，请在手机上完成支付，在此过程中请勿关闭此弹框！\r\n                        <div class=\"tips\">（若支付失败或有其他问题，可加QQ群1234567890联系管理员处理）</div>\r\n                    </div>\r\n                </div>\r\n                <div style=\"display:flex;align-items:center;justify-content: center;position: absolute;bottom: 10px;left: calc((100% - 243px) / 2);\">\r\n                    <!-- <el-checkbox v-model=\"checked1\" label=\"我已阅读并同意\" size=\"large\"></el-checkbox> -->\r\n                    <div class=\"read-text\">请注意：扫码支付代表您已阅读并同意</div>\r\n                    <span class=\"agreement\" @click=\"goToCurrencyAgreement\">《{{ agreementName }}》</span>\r\n                </div>\r\n            </el-dialog>\r\n            <!-- 视频 -->\r\n            <div class=\"left-middle\" >\r\n                <VideoPlay v-if=\"showVideoPlayer\"  :sources=\"sources\" :isLive=\"isLive\" :poster=\"poster\" :autoplay=\"autoplay\"></VideoPlay>\r\n            </div>\r\n            <div class=\"left-bottom-pc\">\r\n                <span style=\"font-weight:700;\">课程详情</span>\r\n                <div class=\"intro\">\r\n                    {{ courseData.description }}\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!-- 右侧列表 -->\r\n        <div class=\"right\">\r\n            <div class=\"right-top\">\r\n                <div class=\"multi-line-ellipsis-1\" style=\"width:80%;\">{{ courseData.title }}</div>\r\n                <!-- <div style=\"font-size:0.8rem;color: #6D6D6D;line-height: 1.6;\">({{courseData}}/{{ courseData. }})</div> -->\r\n            </div>\r\n            <div class=\"list\">\r\n                <div v-for=\"video in videoList\" :key=\"video.id\" class=\"item\" @click=\"handleVideoClick(video.id)\"  :class=\"{ 'selected': video.id ===  selectedVideo}\" >\r\n                    <div class=\"item-name\">{{ video.title }}</div>\r\n                    <div class=\"duration\">{{ video.duration }}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"left-bottom-phone\">\r\n            <span style=\"font-weight:700;\">课程详情</span>\r\n            <div class=\"intro\">\r\n                {{ courseData.description }}\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref,onMounted,computed,watch,onUnmounted} from 'vue'\r\nimport { PageTitle } from '@/utils/fileService.js'\r\nimport TheHeader from '@/page/components/TheHeader.vue'\r\nimport VideoPlay from '@/page/components/VideoPlay.vue';\r\nimport { useRoute } from 'vue-router';\r\nimport { ElMessage } from 'element-plus';\r\nimport axios from '@/utils/request';\r\nimport {getVideoPaperFromCOS} from '@/utils/cosService';\r\nimport Vue3Qrcode from 'vue3-qrcode';\r\nimport YyButton from \"@/page/components/YyButton.vue\";\r\nimport { useRouter } from 'vue-router';\r\nimport { openUrl } from '@/utils/routeJudge'\r\n\r\nconst router = useRouter()\r\n\r\nconst codeUrl = ref();\r\nconst route = useRoute ();\r\nconst courseId = parseInt(route.params.id,10);//路径中的ID\r\nconst setPageTitle = PageTitle('正在加载...');\r\nconst selectedVideo = ref()//用户所选视频的id\r\nconst agreementName = ref('有渔货币协议')//支付弹框中必须阅读的协议\r\nconst videoList = ref([]);\r\nconst courseData = ref({});\r\nconst videoUrl = ref();\r\nconst showVideoPlayer = ref(true);\r\nconst dialogPayVisible = ref(false);//选择支付方式弹框\r\nconst dialogInputCodeVisible = ref(false)//输入兑换码弹框\r\nconst dialogWeiChatVisible = ref(false )//微信支付弹框\r\nconst courseCode = ref('')//用户输入的兑换码\r\nconst videoPayState = ref()//获取用户购买整套视频的状态\r\nconst orderId = ref();\r\nconst intervalId = ref(null);// 定义定时器 ID\r\n\r\n//视频组件传值\r\nconst isLive = ref(false);\r\nconst poster = ref();\r\nconst autoplay = ref(false);\r\nconst sources = computed(() => [\r\n  {  \r\n    type: \"video/mp4\",\r\n    src: videoUrl.value,\r\n  }\r\n]);\r\n\r\nwatch(videoUrl, (newValue, oldValue) => {\r\n  if (newValue !== oldValue) {\r\n    showVideoPlayer.value = false;\r\n    setTimeout(() => {\r\n      showVideoPlayer.value = true;\r\n    }, 400); // 1秒后重新渲染子组件\r\n  }\r\n});\r\n\r\n//处理毫秒数的函数\r\nconst formatDuration = (milliseconds) => {\r\n  let seconds = Math.floor(milliseconds / 1000);\r\n  let minutes = Math.floor(seconds / 60);\r\n  let hours = Math.floor(minutes / 60);\r\n  seconds = seconds % 60;\r\n  minutes = minutes % 60;\r\n  const paddedHours = hours.toString().padStart(2, '0');\r\n  const paddedMinutes = minutes.toString().padStart(2, '0');\r\n  const paddedSeconds = seconds.toString().padStart(2, '0');\r\n  return `${paddedHours}:${paddedMinutes}:${paddedSeconds}`;\r\n};\r\n\r\n// 点击打开输入兑换码弹框\r\nconst goToInputCode = () =>{\r\n    dialogInputCodeVisible.value = true;\r\n    dialogPayVisible.value = false;\r\n}\r\n\r\n// 点击打开微信支付弹框\r\nconst goToWeiChatPay = () =>{\r\n    dialogWeiChatVisible.value = true;\r\n    dialogPayVisible.value = false;\r\n    getPaperVideoCodeUrl();\r\n}\r\n\r\n// 跳转至货币协议\r\nconst goToCurrencyAgreement = () =>{\r\n    // const routeLocation = router.resolve({ path: `/CurrencyAgreement` });\r\n    // window.open(routeLocation.href, '_blank');\r\n    openUrl(`/CurrencyAgreement`)\r\n}\r\n\r\n//点击选择视频\r\nasync function handleVideoClick(videoid){\r\n    const status = await getPaperVideoClipPurchaseState(videoid);\r\n    selectedVideo.value = videoid;\r\n    if(status != 0){\r\n        videoUrl.value = await getVideoPaperFromCOS(videoid);\r\n    }else{\r\n        dialogPayVisible.value = true;\r\n    }\r\n}\r\n\r\n//生成视频订单接口\r\nasync function getPaperVideoCodeUrl() {\r\n  try {\r\n    const queryParams = new URLSearchParams({\r\n        videoId: Number(courseId),\r\n    }).toString();\r\n    const response = await axios.post(`/wechat/paper?${queryParams}`);\r\n    if(response.data.code === 1){\r\n        codeUrl.value = response.data.data.codeUrl;\r\n        orderId.value = response.data.data.orderId;\r\n        intervalId.value = setInterval(getWechatPaperVideoPurchaseState, 2500);\r\n        setTimeout(() => {\r\n            if (intervalId.value) {\r\n            clearInterval(intervalId.value);\r\n            intervalId.value = null;\r\n            }\r\n        }, 600000); \r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"生成视频订单失败\");\r\n        ElMessage.error(\"生成视频订单失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"生成视频订单失败\", error); \r\n    ElMessage.error(\"生成视频订单失败\");\r\n  }\r\n}\r\n\r\n//查询视频订单状态状态接口\r\nasync function getWechatPaperVideoPurchaseState() {\r\n  try {\r\n    if (!dialogWeiChatVisible.value) {\r\n        clearInterval(intervalId.value);\r\n        return; // 退出函数\r\n    }\r\n    const response = await axios.get(`/wechat/paper/${orderId.value}`);\r\n    if(response.data.code === 1){\r\n        if(response.data.data === 1){\r\n            ElMessage.success(\"购买视频成功\");\r\n            setTimeout(() => {\r\n                window.location.reload();\r\n            }, 1000);\r\n        }\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"购买视频失败\");\r\n        ElMessage.error(\"购买视频失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"购买视频失败\", error); \r\n    ElMessage.error(\"购买视频失败\");\r\n  }\r\n}\r\n\r\n\r\n//用户用兑换码购买视频接口\r\nasync function getPaperVideoPurchaseByCdkey() {\r\n  try {\r\n    const response = await axios.get(`/paper/video/purchase/by/cdkey`, {\r\n        params: {\r\n            key:courseCode.value,\r\n            id:courseId,\r\n        }\r\n    });\r\n    if(response.data.code === 1){\r\n        ElMessage.success(\"兑换视频成功\");\r\n        setTimeout(() => {\r\n            window.location.reload();\r\n        }, 1000);\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"兑换视频失败\");\r\n        ElMessage.error(\"兑换视频失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"兑换视频失败\", error); \r\n    ElMessage.error(\"兑换视频失败\");\r\n  }\r\n}\r\n\r\n\r\n//获取用户购买视频的状态接口\r\nasync function getPaperVideoPurchaseState(courseId) {\r\n  try {\r\n    const response = await axios.get(`/paper/video/purchase/state/${courseId}`);\r\n    if(response.data.code === 1){\r\n        videoPayState.value = response.data.data;\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"查询视频订单状态失败\");\r\n        ElMessage.error(\"查询视频订单状态失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"查询视频订单状态失败\", error); \r\n    ElMessage.error(\"查询视频订单状态失败\");\r\n  }\r\n}\r\n\r\n//获取用户购买视频切片的状态接口\r\nasync function getPaperVideoClipPurchaseState(id) {\r\n  try {\r\n    const response = await axios.get(`/paper/video/clip/purchase/state/${id}`);\r\n    if(response.data.code === 1){\r\n        return (response.data.data);\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"获取购买状态失败\");\r\n        ElMessage.error(\"获取购买状态失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取购买状态失败\", error); \r\n    ElMessage.error(\"获取购买状态失败\");\r\n  }\r\n}\r\n\r\n\r\n//根据id获取视频信息接口\r\nasync function getPaperVideoOptions() {\r\n  try {\r\n    const response = await axios.get(`/paper/video/${courseId}`);\r\n    if(response.data.code === 1){\r\n        courseData.value = response.data.data;\r\n        setPageTitle(`${courseData.value.title}视频 - 云联知渔`);\r\n        poster.value = courseData.value.coverPicture;\r\n        courseData.value.price =  courseData.value.price/100;\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"获取视频信息数据失败\");\r\n        ElMessage.error(\"获取视频信息数据失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取视频信息数据失败\", error); \r\n    ElMessage.error(\"获取视频信息数据失败\");\r\n  }\r\n}\r\n\r\n//获取视频对应的切片数据接口\r\nasync function getPaperVideoClipOptions() {\r\n  try {\r\n    const response = await axios.get(`/paper/video/clip/list`,{\r\n        params: {\r\n            id:courseId,\r\n            page:1,\r\n            pageSize:100,\r\n        }\r\n      });\r\n    if(response.data.code === 1){\r\n        videoList.value = response.data.data.records;\r\n        for(let record of  videoList.value){\r\n            record.duration = formatDuration( record.duration );\r\n        }\r\n        videoUrl.value = await getVideoPaperFromCOS(response.data.data.records[0].id);\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"获取学科对应的视频数据失败\");\r\n        ElMessage.error(\"获取学科对应的视频数据失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取学科对应的视频数据失败\", error); \r\n    ElMessage.error(\"获取学科对应的视频数据失败\");\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n    getPaperVideoPurchaseState(courseId);\r\n    getPaperVideoOptions();\r\n    getPaperVideoClipOptions();\r\n});\r\n\r\nonUnmounted(() => {\r\n  // 组件卸载时清除定时器\r\n  if (intervalId.value) {\r\n    clearInterval(intervalId.value);\r\n  }\r\n});\r\n\r\n</script>\r\n\r\n<style>\r\nbody{\r\n    background: #F8F8F8;\r\n}\r\n</style>\r\n<style scoped>\r\n.large-box{\r\n    width: 1200px;\r\n    margin: 3.5rem auto 3rem;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: flex-start;\r\n}\r\n.left{\r\n    width: 72%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 1.2rem;\r\n}\r\n.left-top{\r\n    width: 95%;\r\n    margin: 0 auto;\r\n}\r\n.title{\r\n    font-weight: 700;\r\n    display: inline-block;\r\n    margin-bottom: 0.6rem;\r\n    font-size: 1.5rem;\r\n}\r\n.time{\r\n    font-size: 0.8rem;\r\n    color: #706969;\r\n}\r\n.purperson-num{\r\n    font-size: 0.8rem;\r\n    color: #00A6DA;\r\n    margin-left: 2rem;\r\n}\r\n.content{\r\n    gap: 2rem;\r\n    display: flex;\r\n    justify-content: center;\r\n    margin-top: 1rem;\r\n}\r\n.youyu-btn{\r\n    font-size:0.8rem;\r\n    padding: 6px 15px;\r\n    position: absolute;\r\n    right: 0;\r\n    bottom: 0;\r\n}\r\n.QRcode{\r\n    width: 12rem;\r\n    height: 12rem;\r\n    background-color: #f7e9e9;\r\n}\r\n.QRcode img{\r\n    width: 12rem;\r\n    height: 12rem;\r\n}\r\n.pay-info{\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-evenly;\r\n}\r\n.pay{\r\n    font-size: 1.2rem;\r\n    font-weight: 700;\r\n}\r\n.read-text{\r\n    font-size: 0.6rem;\r\n}\r\n.pay-icon img{\r\n    width: 2.8rem;\r\n    height: 2rem;\r\n    cursor: pointer;\r\n}\r\n.agreement{\r\n    font-size: 0.6rem;\r\n    padding: 0 0.1rem;\r\n    color: #00A6DA;\r\n    border-bottom: 1px solid #00A6DA;\r\n    cursor: pointer;\r\n}\r\n.left-middle{\r\n    width: 95%;\r\n    margin: 0 auto;\r\n    height: 70vh;\r\n}\r\n.left-bottom-pc{\r\n    width: 100%;\r\n}\r\n.left-bottom-phone{\r\n    display: none;\r\n}\r\n.intro{\r\n    margin-top: 0.5rem;\r\n    padding: 0 0.5rem;\r\n    line-height: 1.6;\r\n    color: #706969;\r\n}\r\n.right{\r\n    width: 25%;\r\n    background: #F2F2F2;\r\n    padding: 1rem 0rem;\r\n}\r\n.right-top{\r\n    width: 90%;\r\n    height: calc(5% - 0.8rem);\r\n    line-height: 1.6;\r\n    padding-bottom: 0.8rem;\r\n    margin: 0 5% 0;\r\n    border-bottom: 1px solid #DADADA;\r\n    display: flex;\r\n    justify-content: space-between;\r\n}\r\n.list{\r\n    max-height: 90vh;\r\n    width: 80%;\r\n    padding: 1rem 10%;\r\n    overflow-y: auto;\r\n}\r\n.item{\r\n    width: 100%;\r\n    padding: 0.7rem 0rem;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n}\r\n.duration{\r\n    font-size:0.8rem;\r\n    color:#6D6D6D;\r\n}\r\n.item:hover,\r\n.item:hover .duration,\r\n.item.selected,\r\n.item.selected .duration{\r\n    color: #00A6DA;\r\n    cursor: pointer;\r\n}\r\n:deep .el-dialog{\r\n    width: 50%;\r\n    height: 40vh;\r\n    margin-top: 20vh;\r\n}\r\n:deep(.weichat-dialog .el-dialog__body) {\r\n    padding: 0 ;\r\n}\r\n/* 订单创建 */\r\n.notification-box {\r\n    display: flex;\r\n    align-items: center;\r\n    background-color: #f9f9f9;\r\n    border: 1px solid #e7e7e7;\r\n    border-radius: 4px;\r\n    padding: 10px;\r\n    width: 80%;\r\n    margin: 10px auto;\r\n}\r\n\r\n.checkmark-circle {\r\n  width: 30px;\r\n  height: 30px;\r\n  border-radius: 50%;\r\n  background-color: #4CAF50;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin-right: 15px;\r\n}\r\n.notification-text {\r\n  color: #333;\r\n  font-size: 16px;\r\n  line-height: 1.6;\r\n}\r\n.tips{\r\n    font-size: 0.8rem;\r\n    line-height: 1.6;\r\n}\r\n:deep .checkmark-circle .el-icon svg {\r\n    height: 1.5rem;\r\n    width: 1.5em;\r\n}\r\n:deep .checkmark-circle .el-icon svg {\r\n    color: #fff;\r\n}\r\n@media (max-width:768px){\r\n    .large-box{\r\n        width: 100%;\r\n        flex-direction: column;\r\n    }\r\n    .left{\r\n        width: 100%;\r\n    }\r\n    .right{\r\n        width: 100%;\r\n        margin: 1rem 0;\r\n    }\r\n    .left-middle{\r\n        height: 35vh;\r\n    }\r\n    .left-bottom-pc{\r\n        display: none;\r\n    }\r\n    .left-bottom-phone{\r\n        display: initial;\r\n        width: 96%;\r\n        padding: 0 2%;\r\n    }\r\n    .intro{\r\n        padding: 0 1rem;\r\n    }\r\n    .list{\r\n        max-height: 12vh;\r\n        width: 96%;\r\n        display: flex;\r\n        gap: 2rem;\r\n        padding: 0.5rem 2%;\r\n    }\r\n    .item{\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        padding: 0.3rem 0rem;\r\n        gap: 0.3rem;\r\n    }\r\n    .item-name{\r\n        width: 5rem;\r\n    }\r\n    .content{\r\n        margin-top: 2rem;\r\n        gap: 1rem;\r\n    }\r\n    .QRcode{\r\n        width: 8rem;\r\n        height: 8rem;\r\n    }\r\n    .QRcode img{\r\n        width: 8rem;\r\n        height: 8rem;\r\n    }\r\n    .pay{\r\n        font-size: 1rem;\r\n    }\r\n    :deep .el-dialog{\r\n        width: 100%;\r\n        height: 40vh;\r\n        margin-top: 25vh;\r\n    }\r\n    .youyu-btn{\r\n        right: -6px;\r\n    }\r\n    \r\n    .notification-box {\r\n        width: 90%;\r\n    }\r\n    .notification-text{\r\n        font-size: 0.8rem;\r\n    }\r\n    .tips{\r\n        font-size: 0.6rem;\r\n    }\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}