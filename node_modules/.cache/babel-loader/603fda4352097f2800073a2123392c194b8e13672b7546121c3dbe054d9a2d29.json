{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock, createVNode as _createVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '@/assets/VerifiedUser.svg';\nimport _imports_1 from '@/assets/Comment.svg';\nimport _imports_2 from '@/assets/FavoriteBefore.svg';\nimport _imports_3 from '@/assets/FavoriteAfter.svg';\nimport _imports_4 from '@/assets/More.svg';\nconst _withScopeId = n => (_pushScopeId(\"data-v-38341778\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  style: {\n    \"display\": \"flex\",\n    \"height\": \"100%\",\n    \"gap\": \"1rem\"\n  }\n};\nconst _hoisted_2 = {\n  class: \"pic-container\"\n};\nconst _hoisted_3 = [\"src\"];\nconst _hoisted_4 = {\n  class: \"share-info\"\n};\nconst _hoisted_5 = {\n  class: \"top\"\n};\nconst _hoisted_6 = {\n  class: \"user\"\n};\nconst _hoisted_7 = [\"src\"];\nconst _hoisted_8 = {\n  style: {\n    \"display\": \"flex\",\n    \"flex-direction\": \"column\",\n    \"align-items\": \"flex-start\",\n    \"gap\": \"0.2rem\"\n  }\n};\nconst _hoisted_9 = {\n  style: {\n    \"display\": \"flex\",\n    \"align-items\": \"center\",\n    \"gap\": \"3px\"\n  }\n};\nconst _hoisted_10 = {\n  class: \"name\"\n};\nconst _hoisted_11 = {\n  key: 0,\n  src: _imports_0,\n  style: {\n    \"width\": \"16px\",\n    \"height\": \"16px\"\n  },\n  alt: \"\"\n};\nconst _hoisted_12 = {\n  class: \"time\"\n};\nconst _hoisted_13 = {\n  class: \"content-wrapper\"\n};\nconst _hoisted_14 = {\n  class: \"middle\"\n};\nconst _hoisted_15 = {\n  class: \"icons-container\"\n};\nconst _hoisted_16 = {\n  class: \"icon\"\n};\nconst _hoisted_17 = [\"src\"];\nconst _hoisted_18 = {\n  class: \"like_num\"\n};\nconst _hoisted_19 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_1,\n  alt: \"\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_20 = {\n  class: \"icon\"\n};\nconst _hoisted_21 = {\n  key: 1,\n  class: \"like-pic\",\n  src: _imports_3\n};\nconst _hoisted_22 = {\n  class: \"like_num\"\n};\nconst _hoisted_23 = {\n  key: 0\n};\nconst _hoisted_24 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_4,\n  alt: \"\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_25 = {\n  key: 0,\n  class: \"report-box\"\n};\nconst _hoisted_26 = {\n  key: 0,\n  class: \"last\"\n};\nconst _hoisted_27 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_carousel_item = _resolveComponent(\"el-carousel-item\");\n  const _component_el_carousel = _resolveComponent(\"el-carousel\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_el_dialog, {\n    class: \"share-dialog\",\n    modelValue: $setup.localDialogVisible,\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $setup.localDialogVisible = $event),\n    style: {\n      \"width\": \"90%\",\n      \"height\": \"90vh\",\n      \"margin-top\": \"7vh\"\n    }\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createCommentVNode(\" 左侧轮播图 \"), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_carousel, {\n      interval: 5000,\n      arrow: \"always\"\n    }, {\n      default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.shareData.newCoverPicture, item => {\n        return _openBlock(), _createBlock(_component_el_carousel_item, {\n          key: item\n        }, {\n          default: _withCtx(() => [_createElementVNode(\"img\", {\n            style: {\n              \"width\": \"100%\",\n              \"height\": \"100%\"\n            },\n            src: item,\n            alt: \"Image\"\n          }, null, 8 /* PROPS */, _hoisted_3)]),\n          _: 2 /* DYNAMIC */\n        }, 1024 /* DYNAMIC_SLOTS */);\n      }), 128 /* KEYED_FRAGMENT */))]),\n      _: 1 /* STABLE */\n    })]), _createCommentVNode(\" 右侧分享信息+评论部分 \"), _createElementVNode(\"div\", _hoisted_4, [_createCommentVNode(\" 具体的分享信息 \"), _createElementVNode(\"div\", _hoisted_5, [_createCommentVNode(\" 作者头像+名称 \"), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"img\", {\n      style: {\n        \"width\": \"30px\",\n        \"height\": \"30px\",\n        \"border-radius\": \"50%\"\n      },\n      src: $setup.shareData.newAvater,\n      alt: \"\"\n    }, null, 8 /* PROPS */, _hoisted_7), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"span\", _hoisted_10, _toDisplayString($setup.shareData.username), 1 /* TEXT */), $setup.shareData.verified === 1 ? (_openBlock(), _createElementBlock(\"img\", _hoisted_11)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"span\", _hoisted_12, _toDisplayString($setup.shareData.createTime), 1 /* TEXT */)])]), _createCommentVNode(\" 分享内容 \"), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"p\", {\n      class: _normalizeClass([{\n        'limited': _ctx.needsExpansion\n      }, \"content-text\"])\n    }, _toDisplayString($setup.shareData.content), 3 /* TEXT, CLASS */), $setup.shareData.showExpansion ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 0,\n      onClick: $setup.OpenExpension,\n      class: \"expand-btn\"\n    }, _toDisplayString($setup.shareData.needsExpansion ? '展开' : '折叠'), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])]), _createCommentVNode(\" 点赞,收藏等图标 \"), _createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_createCommentVNode(\" 点赞 \"), _createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"img\", {\n      class: \"like-pic\",\n      src: $setup.shareData.likeStatus === 0 ? $setup.unlikedImage : $setup.likedImage,\n      onClick: _cache[0] || (_cache[0] = $event => $setup.toggleLike($setup.shareData.likeStatus, $setup.shareData.id))\n    }, null, 8 /* PROPS */, _hoisted_17), _createElementVNode(\"span\", _hoisted_18, _toDisplayString($setup.shareData.likeCount), 1 /* TEXT */)]), _createCommentVNode(\" 评论 \"), _createElementVNode(\"div\", {\n      onClick: $setup.OpenComment,\n      class: \"icon\"\n    }, [_hoisted_19, _createElementVNode(\"span\", null, _toDisplayString($setup.shareData.commentCount), 1 /* TEXT */)]), _createCommentVNode(\" 收藏 \"), _createElementVNode(\"div\", _hoisted_20, [$setup.shareData.favoriteStatus === 0 ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 0,\n      class: \"like-pic\",\n      src: _imports_2,\n      onClick: _cache[1] || (_cache[1] = $event => $setup.handleUpdateShare())\n    })) : _createCommentVNode(\"v-if\", true), $setup.shareData.favoriteStatus === 1 ? (_openBlock(), _createElementBlock(\"img\", _hoisted_21)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"span\", _hoisted_22, _toDisplayString($setup.shareData.favoriteCount), 1 /* TEXT */)]), _createCommentVNode(\" 分享收藏列表弹框 \"), $setup.dialogFormVisible ? (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [_createVNode($setup[\"CfDialog\"], {\n      class: \"cf-dialog\",\n      onUpdateValue: $setup.handleUpdateValue,\n      modelValue: $setup.dialogFormVisible,\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.dialogFormVisible = $event),\n      ClassifyName: \"分享收藏\"\n    }, null, 8 /* PROPS */, [\"modelValue\"])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 更多 \"), _createElementVNode(\"div\", {\n      class: \"icon\",\n      style: {\n        \"position\": \"relative\"\n      },\n      onClick: _cache[5] || (_cache[5] = $event => {\n        $setup.ReportBtn = true;\n      })\n    }, [_hoisted_24, $setup.ReportBtn ? (_openBlock(), _createElementBlock(\"div\", _hoisted_25, [_createElementVNode(\"span\", {\n      onClick: _cache[3] || (_cache[3] = $event => {\n        $setup.dialogVisible = true;\n      }),\n      onMouseleave: _cache[4] || (_cache[4] = $event => {\n        $setup.ReportBtn = false;\n      })\n    }, \"举报\", 32 /* NEED_HYDRATION */)])) : _createCommentVNode(\"v-if\", true)])])]), _createCommentVNode(\" 评论区 \"), $setup.showDialogComments && $setup.shareData.needsExpansion ? (_openBlock(), _createElementBlock(\"div\", _hoisted_26, [_createVNode($setup[\"DialogComment\"], {\n      shareId: $setup.shareId,\n      shareAuthorId: $setup.shareAuthorId,\n      shareAuthorName: $setup.shareAuthorName,\n      shareTitle: $setup.shareTitle\n    }, null, 8 /* PROPS */, [\"shareId\", \"shareAuthorId\", \"shareAuthorName\", \"shareTitle\"])])) : _createCommentVNode(\"v-if\", true)])])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), $setup.dialogVisible ? (_openBlock(), _createElementBlock(\"div\", _hoisted_27, [_createVNode($setup[\"AreportedDialog\"], {\n    modelValue: $setup.dialogVisible,\n    \"onUpdate:modelValue\": _cache[7] || (_cache[7] = $event => $setup.dialogVisible = $event)\n  }, null, 8 /* PROPS */, [\"modelValue\"])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["_imports_0","_imports_1","_imports_2","_imports_3","_imports_4","style","class","src","alt","_createElementVNode","_createElementBlock","_createVNode","_component_el_dialog","$setup","localDialogVisible","$event","_hoisted_1","_createCommentVNode","_hoisted_2","_component_el_carousel","interval","arrow","_Fragment","_renderList","shareData","newCoverPicture","item","_createBlock","_component_el_carousel_item","key","_hoisted_4","_hoisted_5","_hoisted_6","newAvater","_hoisted_8","_hoisted_9","_hoisted_10","_toDisplayString","username","verified","_hoisted_11","_hoisted_12","createTime","_hoisted_13","_normalizeClass","_ctx","needsExpansion","content","showExpansion","onClick","OpenExpension","_hoisted_14","_hoisted_15","_hoisted_16","likeStatus","unlikedImage","likedImage","_cache","toggleLike","id","_hoisted_18","likeCount","OpenComment","_hoisted_19","commentCount","_hoisted_20","favoriteStatus","handleUpdateShare","_hoisted_21","_hoisted_22","favoriteCount","dialogFormVisible","_hoisted_23","onUpdateValue","handleUpdateValue","ClassifyName","ReportBtn","_hoisted_24","_hoisted_25","dialogVisible","onMouseleave","showDialogComments","_hoisted_26","shareId","shareAuthorId","shareAuthorName","shareTitle","_hoisted_27"],"sources":["D:\\有渔\\前端源码\\YouyuBBS-Q - 副本\\youyu-lyn-qtnew-vision-new-2024.1.14\\src\\page\\ShareShow\\components\\ShareDialog.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <el-dialog class=\"share-dialog\" v-model=\"localDialogVisible\" style=\"width: 90%;height: 90vh;margin-top: 7vh;\">\r\n            <div style=\"display: flex;height: 100%;gap: 1rem;\">\r\n                <!-- 左侧轮播图 -->\r\n                <div class=\"pic-container\">\r\n                    <el-carousel :interval=\"5000\" arrow=\"always\">\r\n                        <el-carousel-item v-for=\"item in shareData.newCoverPicture\" :key=\"item\">\r\n                            <img style=\"width: 100%;height: 100%;\" :src=\"item\"  alt=\"Image\" />\r\n                        </el-carousel-item>\r\n                    </el-carousel>\r\n                </div>\r\n                <!-- 右侧分享信息+评论部分 -->\r\n                <div class=\"share-info\">\r\n                    <!-- 具体的分享信息 -->\r\n                    <div class=\"top\">\r\n                        <!-- 作者头像+名称 -->\r\n                        <div class=\"user\">\r\n                            <img style=\"width: 30px;height: 30px;border-radius: 50%;\" :src=\"shareData.newAvater\" alt=\"\">\r\n                            <div style=\"display: flex;flex-direction: column;align-items: flex-start;gap: 0.2rem;\">\r\n                                <div style=\"display: flex;align-items: center;gap: 3px;\">\r\n                                    <span class=\"name\">{{ shareData.username }}</span>\r\n                                    <img v-if=\"shareData.verified === 1\" src=\"@/assets/VerifiedUser.svg\" style=\"width: 16px;height: 16px;\" alt=\"\">\r\n                                </div>\r\n                                <span class=\"time\">{{ shareData.createTime }}</span>\r\n                            </div>\r\n                        </div>\r\n                        <!-- 分享内容 -->\r\n                        <div  class=\"content-wrapper\" >\r\n                            <p :class=\"{ 'limited': needsExpansion }\" class=\"content-text\">\r\n                                {{ shareData.content }}\r\n                            </p>\r\n                            <button \r\n                                v-if=\" shareData.showExpansion\" \r\n                                @click= \"OpenExpension\"\r\n                                class=\"expand-btn\"\r\n                            >\r\n                                {{  shareData.needsExpansion ? '展开':'折叠'   }}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <!-- 点赞,收藏等图标 -->\r\n                    <div class=\"middle\">\r\n                        <div class=\"icons-container\">\r\n                            <!-- 点赞 -->\r\n                            <div class=\"icon\">\r\n                                <img class=\"like-pic\"  :src=\" shareData.likeStatus === 0 ? unlikedImage : likedImage \" @click=\"toggleLike(shareData.likeStatus,shareData.id)\">\r\n                                <span class=\"like_num\">{{ shareData.likeCount }}</span>\r\n                            </div>\r\n                            <!-- 评论 -->\r\n                            <div @click=\"OpenComment\" class=\"icon\">\r\n                                <img src=\"@/assets/Comment.svg\" alt=\"\">\r\n                                <span>{{ shareData.commentCount }}</span>\r\n                            </div>\r\n                            <!-- 收藏 -->\r\n                            <div class=\"icon\">\r\n                                <img class=\"like-pic\"  v-if=\" shareData.favoriteStatus === 0 \" src=\"@/assets/FavoriteBefore.svg\" @click=\"handleUpdateShare()\">\r\n                                <img class=\"like-pic\" v-if=\" shareData.favoriteStatus === 1 \" src=\"@/assets/FavoriteAfter.svg\" >\r\n                                <span class=\"like_num\">{{ shareData.favoriteCount }}</span>\r\n                            </div>\r\n                            <!-- 分享收藏列表弹框 -->\r\n                            <div v-if=\"dialogFormVisible\">\r\n                                <CfDialog  class=\"cf-dialog\" @updateValue=\"handleUpdateValue\" v-model=\"dialogFormVisible\"  ClassifyName=\"分享收藏\"></CfDialog>\r\n                            </div>\r\n                            <!-- 更多 -->\r\n                            <div class=\"icon\" style=\"position: relative;\" @click=\"ReportBtn = true;\" >\r\n                                <img src=\"@/assets/More.svg\" alt=\"\">\r\n                                <div v-if=\"ReportBtn\"  class=\"report-box\">\r\n                                    <span @click=\"dialogVisible = true;\" @mouseleave=\"ReportBtn = false;\">举报</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <!-- 评论区 -->\r\n                    <div class=\"last\" v-if=\"showDialogComments && shareData.needsExpansion\">\r\n                        <DialogComment  :shareId=\"shareId\" :shareAuthorId=\"shareAuthorId\" :shareAuthorName=\"shareAuthorName\" :shareTitle=\"shareTitle\"></DialogComment>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </el-dialog>\r\n        <div v-if=\"dialogVisible\">\r\n            <AreportedDialog v-model=\"dialogVisible\" ></AreportedDialog>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { defineProps, ref,defineEmits,watchEffect,onMounted,watch} from \"vue\";\r\nimport DialogComment from \"./DialogComment.vue\";\r\nimport AreportedDialog from '@/page/components/AreportedDialog.vue';\r\nimport CfDialog from '@/page/components/CfDialog';\r\nimport { fetchShareCoverage } from '@/utils/fileService';\r\nimport { getUsersAvatarFromCOS } from '@/utils/cosService';\r\nimport axios from '@/utils/request';\r\nimport { ElMessage } from 'element-plus';\r\nimport unlikedImage from '@/assets/LikeBefore.svg';\r\nimport likedImage from '@/assets/LikeAfter.svg';\r\n\r\nconst props = defineProps({\r\n    modelValue: Boolean,\r\n    Id:Number,\r\n});\r\nconst emit = defineEmits(['update:modelValue']);\r\nconst localDialogVisible = ref(props.modelValue);\r\nwatchEffect(() => {\r\n    if (localDialogVisible.value !== props.modelValue) {\r\n        emit('update:modelValue', localDialogVisible.value);\r\n    }\r\n});\r\n\r\nconst userId = localStorage.getItem(\"userId\"); // 获取用户ID\r\nconst shareData = ref({});\r\nconst limitWord = ref(150);//设置分享在不展开的情况下显示内容的上限\r\nconst showDialogComments = ref(false)//控制评论区显示与否\r\nconst dialogVisible = ref(false);//控制文章举报弹框是否显示\r\nconst dialogFormVisible = ref(false);//控制cfdialog弹窗（显示文章收藏列表）是否弹出\r\nconst ReportBtn = ref(false)//控制举报该条分享按钮是否显示\r\nconst shareId = ref();\r\nconst shareAuthorId = ref();\r\nconst shareAuthorName = ref();\r\nconst shareTitle = ref();\r\nconst favoriteId= ref();\r\n\r\nconst fetchData = () =>{\r\n    shareId.value = props.Id;\r\n    fetchShareData();\r\n}\r\n\r\n//判断该分享的内容是否需要展开收回（写到接口方法里显得太臃肿了所以提出来了）\r\nconst checkContentOverflow = (content) => {\r\n    if (content.length > limitWord.value) {\r\n        return true;\r\n    }\r\n}\r\n\r\n//接受cfdialog返回的数据，从而确定收藏Id\r\nconst handleUpdateValue = (data) => {\r\n    favoriteId.value = data[0];\r\n}\r\n\r\n//点击打开分享弹窗\r\nconst handleUpdateShare = () => {\r\n    dialogFormVisible.value = true;\r\n}\r\n\r\n// 使用 watch 来监听 favoriteId 的变化\r\nwatch(favoriteId, (newVal, oldVal) => {\r\n    if (newVal !== oldVal) {\r\n    toggleFavorite();\r\n    }\r\n});\r\n\r\n\r\n//分享收藏相关接口\r\nasync function toggleFavorite() {\r\n    try {\r\n        const response = await axios.post(`/favorite/share`,{\r\n            favoriteId: favoriteId.value, \r\n            contentId:  props.Id, \r\n        });\r\n        if ( response.data.code === 1) {\r\n            shareData.value.favoriteStatus = 1; \r\n            shareData.value.favoriteCount =  response.data.data;\r\n        } else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else {\r\n            console.error(response.data.msg || 'Unknown error');\r\n            ElMessage.error('分享收藏失败');\r\n        }\r\n    } catch (error) {\r\n    console.error('分享收藏成功', error.message);\r\n    ElMessage.error('分享收藏成功');\r\n    }\r\n}\r\n\r\n//点击展开分享内容\r\nconst OpenExpension = () =>{\r\n    //在准备点击之前还未展开，即needsExpansion为true，此时点击让控制评论区的showDialogComments为false\r\n    if( shareData.value.needsExpansion){\r\n        showDialogComments.value = false\r\n    }\r\n    // 点击展开or折叠状态切换\r\n    shareData.value.needsExpansion = !shareData.value.needsExpansion;\r\n}\r\nconst OpenComment = () =>{\r\n    //若点击评论区图标时，分享内容是展开的 ，即needsExpansion为false，则先收起分享内容，即让needsExpansion为true\r\n    if(!shareData.value.needsExpansion){\r\n        shareData.value.needsExpansion = true\r\n    }\r\n    showDialogComments.value = !showDialogComments.value\r\n}\r\n\r\n//获取分享信息\r\nconst fetchShareData = async () => {\r\n    try {\r\n        const response = await axios.get(`/share/${shareId.value}`)\r\n        if (response.data.code === 1) {\r\n            shareData.value = response.data.data;\r\n            shareAuthorId.value = shareData.value.userId;\r\n            shareAuthorName.value = shareData.value.username;\r\n            shareTitle.value = shareData.value.title;\r\n            shareData.value.verified = await fetchUserInformation(shareData.value.userId);\r\n            shareData.value.newAvater = await getUsersAvatarFromCOS( shareData.value.userId);\r\n            shareData.value.newCoverPicture = await fetchShareCoverage( shareData.value.id);\r\n            shareData.value.likeStatus = await determineImage(1, shareData.value.id);\r\n            shareData.value.favoriteStatus = await deterFavorite(shareData.value.id);\r\n            shareData.value.needsExpansion = checkContentOverflow(shareData.value.content);\r\n            shareData.value.showExpansion = checkContentOverflow(shareData.value.content);\r\n        }else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else{\r\n            ElMessage.error('接口请求失败');\r\n        }\r\n    } catch (error) {\r\n        console.error('接口请求失败', error);\r\n    }\r\n};\r\n\r\n// 获取用户信息\r\nconst fetchUserInformation = async (userId) => {\r\n    try {\r\n        const response = await axios.get(`/users/${userId}`);\r\n        if(response.data.code === 1){\r\n            return (response.data.data.verified);\r\n        }else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else{\r\n            ElMessage.error('获取用户信息失败');\r\n        }\r\n    } catch (error) {\r\n        console.error(\"获取用户信息失败\", error);\r\n        ElMessage.error('获取用户信息失败');\r\n    }\r\n};\r\n\r\n//判断收藏状态\r\nasync function deterFavorite(id) {\r\n    try {\r\n        const response = await axios.get(`/favorite/share/${id}`)\r\n        if ( response.data.code === 1) {\r\n            return response.data.data;\r\n        } else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else {\r\n            console.error(response.data.msg || 'Unknown error');\r\n        }\r\n    } catch (error) {\r\n        console.error('获取点赞状态失败', error.message);\r\n        ElMessage.error('获取收藏状态失败');\r\n    }\r\n}\r\n\r\n//判断点赞状态\r\nasync function determineImage(type,id) {\r\n    try {\r\n        const response = await axios.get(`/like/state`,{\r\n            params: {\r\n                id: id,\r\n                type: type,\r\n            }\r\n        });\r\n        if (response.data.code === 1) {\r\n            return (response.data.data);\r\n        } else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else {\r\n            console.error(response.data.msg || 'Unknown error');\r\n            ElMessage.error('获取点赞状态失败');\r\n        }\r\n    } catch (error) {\r\n    console.error('获取点赞状态失败', error.message);\r\n    }\r\n}\r\n  \r\n//点赞相关方法\r\nasync function toggleLike(likeStatus,shareId) {\r\n    try {\r\n        const config = likeStatus === 0\r\n            ? {\r\n                method: 'put',\r\n                url: `/share/like`,\r\n                data: { userId: userId , shareId: shareId}\r\n            }\r\n            : {\r\n                method: 'delete',\r\n                url: `/share/unlike`,\r\n                data: { userId: userId , shareId: shareId}\r\n            };\r\n        const response = await axios(config);\r\n        if ( response.data.code === 1) {\r\n            shareData.value.likeStatus = shareData.value.likeStatus === 0 ? 1 : 0;\r\n            shareData.value.likeCount =  response.data.data;\r\n        } else if(response.data.code === 0 && response.data.msg){\r\n            ElMessage.error(response.data.msg.toString());\r\n        }else {\r\n            console.error(response.data.msg || 'Unknown error');\r\n            ElMessage.error('点赞操作失败');\r\n        }\r\n    } catch (error) {\r\n        console.error('获取点赞状态失败', error.message);\r\n    }\r\n}\r\n\r\nonMounted(async () => {\r\n    fetchData();\r\n})\r\n\r\n</script>\r\n\r\n<style scoped>\r\n::v-deep .share-dialog .el-dialog__body {\r\n    padding: 20px 30px;\r\n    height: 93%;\r\n}\r\n::v-deep .share-dialog .el-dialog__header {\r\n    padding: 0; \r\n    margin-right: 0;\r\n}\r\n::v-deep .share-dialog .el-carousel--horizontal {\r\n    height: 100%;\r\n}\r\n::v-deep .share-dialog .el-carousel__container{\r\n    height: 100% !important;\r\n}\r\n/* 由于el-dialog嵌套使用,故在一个组件内给两个弹框定义不同类名以防止样式重叠 */\r\n::v-deep .cf-dialog .el-dialog{\r\n    width: 75%;\r\n    height: 80%;\r\n}\r\n::v-deep .cf-dialog .el-dialog__body{\r\n    padding: 10px 30px;\r\n    height: 73%;\r\n}\r\n::v-deep .cf-dialog .el-dialog__header{\r\n    text-align: center;\r\n    padding: var(--el-dialog-padding-primary);\r\n}\r\n::v-deep .cf-dialog .el-dialog__title {\r\n    font-weight: 700;\r\n    font-size: 20px;\r\n}\r\n::v-deep .cf-dialog .el-dialog__headerbtn {\r\n    width: 30px;\r\n    height: 30px;\r\n}\r\n:deep .el-dialog__headerbtn {\r\n    top: -10px;\r\n    right: -10px;\r\n}\r\n.pic-container{\r\n    width: 60%;\r\n    height: 100%;\r\n}\r\n.share-info{\r\n    width: 40%;\r\n    height: 100%;\r\n}\r\n.top{\r\n    padding: 10px;\r\n    min-height: 35%;\r\n    max-height: 70%;\r\n    width: 95%;\r\n    overflow: auto;\r\n    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.08);\r\n}\r\n.user{\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    margin-bottom: 1rem;\r\n}\r\n.name{\r\n    color: #2A7FE4;\r\n}\r\n.time{\r\n    color: #8C8C8C;\r\n    font-size: 12px;\r\n}\r\n.content-wrapper {\r\n    position: relative;\r\n    margin-bottom: 20px;\r\n    position: relative;\r\n}\r\n.content-text{\r\n    color: #333;\r\n    padding: 0px 10px;\r\n    font-size: 14px;\r\n    line-height: 1.8; \r\n    letter-spacing: 1px;\r\n    overflow: hidden;\r\n    display: -webkit-box;\r\n    -webkit-box-orient: vertical;\r\n}\r\n.content-text.limited {\r\n    -webkit-line-clamp: 5;\r\n}\r\n.expand-btn {\r\n    position: absolute;\r\n    bottom: -15px;\r\n    right: 0;\r\n    background-color: transparent; \r\n    border: none;\r\n    cursor: pointer;\r\n    color: #2A7FE4;\r\n    font-size: 14px;\r\n    line-height: 120%; \r\n}\r\n.icons-container{\r\n    display: flex;\r\n    width: 97%;\r\n    height: 30px;\r\n    align-items: center;\r\n    justify-content: space-around;\r\n    margin-top: 10px;\r\n}\r\n.icon{\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 3px;\r\n}\r\n.icon img{\r\n    width: 18px;\r\n    height: 18px;\r\n    cursor: pointer;\r\n}\r\n.icon span{\r\n    color: #2d2d2d;\r\n    font-size: 12px;\r\n}\r\n.report-box{\r\n    position: absolute;\r\n    top: 15px ;\r\n    right: -17px;\r\n    width: 50px;\r\n    height: 26px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    border-radius: 5px; \r\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n}\r\n.report-box span{\r\n    cursor: pointer;\r\n    font-size: 14px;\r\n    color: #5d5d5d;\r\n}\r\n.last{\r\n    width: 100%;\r\n    height: 53%;\r\n    overflow: auto;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}