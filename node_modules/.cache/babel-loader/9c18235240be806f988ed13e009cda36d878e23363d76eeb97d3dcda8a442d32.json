{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport TitleSection from \"@/page/TheSettings/components/TitleSection.vue\";\nimport { ElMessage } from 'element-plus';\nimport axios from '@/utils/request';\nimport YyButton from \"@/page/components/YyButton.vue\";\nconst msg = '问答设置';\nexport default {\n  __name: 'QASetting',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const userId = localStorage.getItem(\"userId\"); // 获取用户ID\n    const textarea = ref('');\n    const text1 = ref();\n    const text2 = ref();\n    const text3 = ref();\n    const text4 = ref();\n    const switch1 = ref(true);\n    const radio1 = ref(''); //指定金额还是金额区间\n    const answererInfo = ref({}); //保存用户的问答设置信息\n\n    //获取答主具体信息\n    async function getAnswererInfo() {\n      try {\n        const response = await axios.get(`/answer/${userId}`);\n        if (response.data.code === 1) {\n          answererInfo.value = response.data.data;\n          if (answererInfo.value.accept == 1) {\n            switch1.value = true;\n          } else if (answererInfo.value.accept == 0) switch1.value = false;\n          if (answererInfo.value.priceLow === answererInfo.value.priceHigh) {\n            radio1.value = '1';\n            text1.value = answererInfo.value.priceLow;\n          } else {\n            radio1.value = '2';\n            text2.value = answererInfo.value.priceLow;\n            text3.value = answererInfo.value.priceHigh;\n          }\n          textarea.value = answererInfo.value.answererInfo;\n          text4.value = answererInfo.value.number;\n          // ElMessage.success('获取答主具体信息成功');\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"获取答主具体信息失败\");\n          ElMessage.error('获取答主具体信息失败');\n        }\n      } catch (error) {\n        console.error(\"获取答主具体信息失败\", error);\n        ElMessage.error('获取答主具体信息失败');\n      }\n    }\n\n    //修改问答信息\n    async function putUserInform() {\n      const acceptStatus = switch1.value ? 1 : 0;\n      let payload = {};\n      if (radio1.value === '1') {\n        payload = {\n          accept: acceptStatus,\n          answererInfo: textarea.value,\n          priceLow: text1.value,\n          priceHigh: text1.value,\n          number: text4.value,\n          type: 0\n        };\n      }\n      if (radio1.value === '2') {\n        payload = {\n          accept: acceptStatus,\n          answererInfo: textarea.value,\n          priceLow: text2.value,\n          priceHigh: text3.value,\n          number: text4.value,\n          type: 0\n        };\n      }\n      try {\n        const response = await axios.put('/answer', payload);\n        if (response.data.code === 1) {\n          console.log(response.data.msg);\n          ElMessage.success(\"修改问答信息成功\");\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"修改问答信息失败\");\n          ElMessage.error(\"修改问答信息失败\");\n        }\n      } catch (error) {\n        console.error(\"修改问答信息失败\", error);\n        ElMessage.error(\"修改问答信息失败\");\n      }\n    }\n    onMounted(() => {\n      getAnswererInfo();\n    });\n    const __returned__ = {\n      userId,\n      msg,\n      textarea,\n      text1,\n      text2,\n      text3,\n      text4,\n      switch1,\n      radio1,\n      answererInfo,\n      getAnswererInfo,\n      putUserInform,\n      ref,\n      onMounted,\n      TitleSection,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get axios() {\n        return axios;\n      },\n      YyButton\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","TitleSection","ElMessage","axios","YyButton","msg","userId","localStorage","getItem","textarea","text1","text2","text3","text4","switch1","radio1","answererInfo","getAnswererInfo","response","get","data","code","value","accept","priceLow","priceHigh","number","error","toString","console","putUserInform","acceptStatus","payload","type","put","log","success"],"sources":["D:/有渔/前端源码/YouyuBBS-Q - 副本/youyu-lyn-qtnew-vision-new-2024.1.14/src/page/TheSettings/components/QASetting.vue"],"sourcesContent":["<template>\r\n  <div class=\"T_M\" style=\"display: flex;flex-direction: column;\">\r\n    <TitleSection :message=msg :show-btn=false />\r\n    <div class=\"page\">\r\n      <div class=\"is-consult\">\r\n        <span class=\"little-title\">接受咨询</span>\r\n        <div class=\"consult-switch\">\r\n          <el-switch v-model=\"switch1\" inline-prompt active-text=\"on\" inactive-text=\"off\" class=\"item-switch\"/>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"anserer-say\">\r\n        <span class=\"little-title\">答主说</span>\r\n        <div class=\"saying-input\">\r\n          <el-input\r\n              v-model=\"textarea\"\r\n              maxlength=\"1000\"\r\n              placeholder=\"分享一下最近的趣事或心情吧\"\r\n              show-word-limit\r\n              type=\"textarea\"\r\n              size=\"large\"\r\n              resize=\"none\"\r\n              :autosize = \"{ minRows: 2, maxRows: 30 }\"\r\n              class=\"input_el\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"money-set\">\r\n        <span class=\"little-title\">问题金额设置</span>\r\n        <div class=\"my-2 flex items-center text-sm\" >\r\n          <el-radio-group v-model=\"radio1\" class=\"radio_share\">\r\n            <el-radio label=\"1\">指定金额</el-radio>\r\n            <el-radio label=\"2\">金额区间</el-radio>\r\n          </el-radio-group>\r\n          <div v-if=\"radio1 === '1'\" class=\"money-num\">\r\n            <input type=\"text\" v-model=\"text1\">\r\n            <span class=\"text1\" >鱼饵</span>\r\n          </div>\r\n          <div v-if=\"radio1 === '2'\" class=\"money-num\">\r\n            <input type=\"text\" v-model=\"text2\">\r\n            <span style=\"margin-right: 10px;\" class=\"text1\">至</span>\r\n            <input type=\"text\" v-model=\"text3\">\r\n            <span class=\"text1\">鱼饵</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"max-question\">\r\n        <span class=\"little-title\">最多接受</span>\r\n        <div>\r\n          <input type=\"text\" v-model=\"text4\">\r\n          <span class=\"text1\">条追问</span>\r\n        </div>\r\n      </div>\r\n      <div style=\"display:flex;margin-bottom: 2rem;\">\r\n        <YyButton theme=\"purple\" @click=\"putUserInform\">保存</YyButton>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref,onMounted } from 'vue';\r\nimport TitleSection from \"@/page/TheSettings/components/TitleSection.vue\";\r\nimport { ElMessage } from 'element-plus';\r\nimport axios from '@/utils/request';\r\nimport YyButton from \"@/page/components/YyButton.vue\";\r\n\r\nconst userId = localStorage.getItem(\"userId\"); // 获取用户ID\r\nconst msg = '问答设置'\r\nconst textarea = ref('')\r\nconst text1 = ref();\r\nconst text2 =ref();\r\nconst text3 = ref();\r\nconst text4 = ref();\r\nconst switch1 = ref(true);\r\nconst radio1 = ref('')//指定金额还是金额区间\r\nconst answererInfo = ref({})//保存用户的问答设置信息\r\n\r\n//获取答主具体信息\r\nasync function getAnswererInfo() {\r\n  try{\r\n    const response = await axios.get(`/answer/${userId}`)\r\n    if(response.data.code === 1){\r\n        answererInfo.value = response.data.data;\r\n        if( answererInfo.value.accept == 1){\r\n          switch1.value = true;\r\n        }else if(answererInfo.value.accept == 0)\r\n          switch1.value = false;\r\n        if(answererInfo.value.priceLow === answererInfo.value.priceHigh){\r\n          radio1.value = '1';\r\n          text1.value =  answererInfo.value.priceLow;\r\n        }else{\r\n          radio1.value = '2';\r\n          text2.value =  answererInfo.value.priceLow;\r\n          text3.value =  answererInfo.value.priceHigh;\r\n        }\r\n        textarea.value = answererInfo.value.answererInfo;\r\n        text4.value =  answererInfo.value.number;\r\n        // ElMessage.success('获取答主具体信息成功');\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"获取答主具体信息失败\");\r\n        ElMessage.error('获取答主具体信息失败');\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取答主具体信息失败\", error); \r\n    ElMessage.error('获取答主具体信息失败');\r\n  }\r\n}\r\n\r\n//修改问答信息\r\nasync function putUserInform() {\r\n  const acceptStatus = switch1.value ? 1 : 0;\r\n  let payload = {};\r\n  if (radio1.value === '1') {\r\n    payload = {\r\n      accept: acceptStatus,\r\n      answererInfo: textarea.value,\r\n      priceLow: text1.value,\r\n      priceHigh: text1.value,\r\n      number: text4.value,\r\n      type:0,\r\n    };\r\n  }\r\n  if (radio1.value === '2') {\r\n    payload = {\r\n      accept: acceptStatus,\r\n      answererInfo: textarea.value,\r\n      priceLow: text2.value,\r\n      priceHigh: text3.value,\r\n      number: text4.value,\r\n      type:0,\r\n    };\r\n  }\r\n\r\n  try {\r\n    const response = await axios.put('/answer', payload);\r\n    if(response.data.code === 1){\r\n        console.log(response.data.msg); \r\n        ElMessage.success(\"修改问答信息成功\");\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"修改问答信息失败\");\r\n        ElMessage.error(\"修改问答信息失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"修改问答信息失败\", error); \r\n    ElMessage.error(\"修改问答信息失败\");\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  getAnswererInfo();\r\n})\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.page {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 50px;\r\n  padding: 30px 50px;\r\n  overflow: auto;\r\n}\r\n.is-consult,\r\n.max-question{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 40px;\r\n}\r\n.anserer-say,\r\n.money-set{\r\n  display: flex;\r\n  align-items: flex-start;\r\n  gap: 40px;\r\n}\r\n\r\n.max-question{\r\n  margin-top: 10px;\r\n}\r\n.little-title{\r\n  display: inline-block;\r\n  width: 100px;\r\n  color: #7D7979;\r\n  line-height: 1.6;\r\n}\r\n.saying-input{\r\n  width: 70%;\r\n}\r\n::v-deep .el-radio{\r\n  height: 21px;\r\n}\r\n::v-deep .el-radio__label{\r\n    width: 100px;\r\n}\r\n/* 修改选中状态的颜色 */\r\n::v-deep .el-radio__input.is-checked .el-radio__inner {\r\n    border:none; \r\n    background-color: #fff; \r\n}\r\n/* 修改选中状态的图标颜色，通常是一个白色的圆点 */\r\n::v-deep .el-radio__input.is-checked .el-radio__inner::after {\r\n    background-color: #000; \r\n}\r\n/* 去除选中框的圆点 */\r\n::v-deep .el-radio__input.is-checked .el-radio__inner::after {\r\n    display: none;\r\n}\r\n/* 添加对勾图案 */\r\n::v-deep .el-radio__input.is-checked .el-radio__inner::before {\r\n    content: \"\"; \r\n    background-image: url('../../../assets/CheckMark.svg');\r\n    background-size: cover;\r\n    border: none;\r\n    background-repeat: no-repeat;\r\n    position: absolute;\r\n    height: 14px;\r\n    width: 14px;\r\n    color: #000;  \r\n}\r\n/* 选中部分字体颜色 */\r\n::v-deep .el-radio__input.is-checked + .el-radio__label {\r\n    color: #161616;;  \r\n    border: none;\r\n}\r\n.radio_share span{\r\n  display: inline-block;\r\n  width: 12px;\r\n  height: 12px;\r\n  font-size: 16px;\r\n  text-align: center;\r\n}\r\n.money-num{\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 20px;\r\n}\r\ninput{\r\n  width: 45px;\r\n  height: 18px;\r\n  padding: 4px 8px;\r\n  border-radius: 8px;\r\n  background: #EDEDED;\r\n  border: 1px solid #e9e9e9;\r\n  text-align: center;\r\n  margin-right: 10px;\r\n}\r\ninput:focus{\r\n  outline: none;\r\n  box-shadow: 0 1px 7px #dbdae5;\r\n  border: 1px solid #d7d7d7;\r\n}\r\n.text1{\r\n  color: #161616;;  \r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}