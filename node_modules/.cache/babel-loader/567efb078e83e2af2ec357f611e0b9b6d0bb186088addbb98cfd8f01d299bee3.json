{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '@/assets/LikeBefore.svg';\nimport _imports_1 from '@/assets/Comment.svg';\nconst _withScopeId = n => (_pushScopeId(\"data-v-d39c8a6a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"cbutton\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"tatitle\"\n}, \"TA的文章\")], -1 /* HOISTED */));\nconst _hoisted_2 = {\n  style: {\n    \"width\": \"100%\"\n  }\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"hh1\",\n  \"infinite-scroll-distance\": \"100\",\n  \"infinite-scroll-immediate\": \"false\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = {\n  class: \"container\"\n};\nconst _hoisted_6 = {\n  class: \"one\"\n};\nconst _hoisted_7 = [\"src\"];\nconst _hoisted_8 = {\n  class: \"two\"\n};\nconst _hoisted_9 = {\n  class: \"multi-line-ellipsis-4\"\n};\nconst _hoisted_10 = {\n  class: \"lall\"\n};\nconst _hoisted_11 = {\n  class: \"classify\"\n};\nconst _hoisted_12 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"cptext\"\n}, \"分类\", -1 /* HOISTED */));\nconst _hoisted_13 = {\n  class: \"clab\"\n};\nconst _hoisted_14 = {\n  class: \"classify\"\n};\nconst _hoisted_15 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"cptext\"\n}, \"标签\", -1 /* HOISTED */));\nconst _hoisted_16 = {\n  class: \"attached\"\n};\nconst _hoisted_17 = {\n  class: \"cri\"\n};\nconst _hoisted_18 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  class: \"like-pic\",\n  src: _imports_0\n}, null, -1 /* HOISTED */));\nconst _hoisted_19 = {\n  class: \"cname\"\n};\nconst _hoisted_20 = {\n  class: \"cri\"\n};\nconst _hoisted_21 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  class: \"like-pic\",\n  src: _imports_1\n}, null, -1 /* HOISTED */));\nconst _hoisted_22 = {\n  class: \"cname\"\n};\nconst _hoisted_23 = {\n  class: \"ptime\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_empty = _resolveComponent(\"el-empty\");\n  const _directive_infinite_scroll = _resolveDirective(\"infinite-scroll\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_hoisted_1, _createElementVNode(\"div\", _hoisted_2, [$setup.articles || $setup.articles.length !== 0 ? _withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.articles, (item, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      class: \"small\",\n      key: index,\n      onClick: $event => $setup.goToDetail(item)\n    }, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"img\", {\n      class: \"largePicture\",\n      src: item.coverPicture,\n      alt: \"\"\n    }, null, 8 /* PROPS */, _hoisted_7)]), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"h3\", null, _toDisplayString(item.title), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_9, _toDisplayString(item.summary), 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_10, [_createCommentVNode(\" 标签 \"), _createElementVNode(\"div\", null, [_createElementVNode(\"div\", _hoisted_11, [_hoisted_12, _createElementVNode(\"span\", _hoisted_13, _toDisplayString(item.subBoardName), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_14, [_hoisted_15, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(item.labels, label => {\n      return _openBlock(), _createElementBlock(\"span\", {\n        class: \"clab\",\n        key: label,\n        round: \"\"\n      }, \"#\" + _toDisplayString(label), 1 /* TEXT */);\n    }), 128 /* KEYED_FRAGMENT */))])]), _createCommentVNode(\" 点赞图标+时间 \"), _createElementVNode(\"div\", null, [_createCommentVNode(\" 点赞图标 \"), _createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"div\", _hoisted_17, [_hoisted_18, _createElementVNode(\"span\", _hoisted_19, _toDisplayString(item.likeCount), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_20, [_hoisted_21, _createElementVNode(\"span\", _hoisted_22, _toDisplayString(item.commentCount), 1 /* TEXT */)])]), _createCommentVNode(\" 时间  \"), _createElementVNode(\"span\", _hoisted_23, _toDisplayString(item.postTime), 1 /* TEXT */)])])], 8 /* PROPS */, _hoisted_4);\n  }), 128 /* KEYED_FRAGMENT */))])), [[_directive_infinite_scroll, $setup.load]]) : (_openBlock(), _createBlock(_component_el_empty, {\n    key: 1,\n    \"image-size\": 200,\n    description: \"他还没有文章呢，逛逛别的吧！\"\n  }))])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_imports_0","_imports_1","_createElementVNode","class","style","src","_hoisted_1","_hoisted_2","$setup","articles","length","_createElementBlock","_hoisted_3","_Fragment","_renderList","item","index","key","onClick","$event","goToDetail","_hoisted_5","_hoisted_6","coverPicture","alt","_hoisted_8","_toDisplayString","title","_hoisted_9","summary","_hoisted_10","_createCommentVNode","_hoisted_11","_hoisted_12","_hoisted_13","subBoardName","_hoisted_14","_hoisted_15","labels","label","round","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","likeCount","_hoisted_20","_hoisted_21","_hoisted_22","commentCount","_hoisted_23","postTime","load","_createBlock","_component_el_empty","description"],"sources":["D:\\有渔\\前端源码\\YouyuBBS-Q - 副本\\youyu-lyn-qtnew-vision-new-2024.1.14\\src\\page\\OtherUserPersonalpage\\articleFavorite\\ArticleListF.vue"],"sourcesContent":["<template>\r\n  <div class=\"cbutton\">\r\n    <span class=\"tatitle\">TA的文章</span>\r\n  </div>\r\n  <div style=\"width: 100%;\">\r\n    <div v-if=\"articles || articles.length !== 0\" class=\"hh1\" v-infinite-scroll=\"load\" infinite-scroll-distance=\"100\" infinite-scroll-immediate=\"false\">\r\n      <div class=\"small\" v-for=\"(item, index) in articles\" :key=\"index\" @click=\"goToDetail(item)\">\r\n        <div class=\"container\">\r\n          <div class=\"one\">\r\n            <img class=\"largePicture\" :src=\"item.coverPicture\" alt=\"\">\r\n          </div>\r\n          <div class=\"two\">\r\n            <h3 >{{ item.title }}</h3>\r\n            <p class=\"multi-line-ellipsis-4\">{{ item.summary }}</p>\r\n          </div>\r\n        </div>\r\n        <div class=\"lall\">\r\n          <!-- 标签 -->\r\n          <div>\r\n            <div class=\"classify\">\r\n              <span class=\"cptext\">分类</span>\r\n              <span class=\"clab\">{{ item.subBoardName }}</span>\r\n            </div>\r\n            <div class=\"classify\">\r\n              <span class=\"cptext\">标签</span>\r\n              <span class=\"clab\" v-for=\"label in item.labels\" :key=\"label\" round>#{{ label }}</span>\r\n            </div>\r\n          </div>\r\n          <!-- 点赞图标+时间 -->\r\n          <div>\r\n            <!-- 点赞图标 -->\r\n            <div class=\"attached\">\r\n              <div class=\"cri\">\r\n                  <img class=\"like-pic\" src=\"@/assets/LikeBefore.svg\">\r\n                  <span class=\"cname\">{{ item.likeCount }}</span>\r\n              </div>\r\n              <div class=\"cri\">\r\n                  <img class=\"like-pic\" src=\"@/assets/Comment.svg\">\r\n                  <span class=\"cname\">{{ item.commentCount }}</span>\r\n              </div>\r\n            </div>   \r\n            <!-- 时间  -->\r\n            <span class=\"ptime\">{{ item.postTime }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <el-empty \r\n        v-else\r\n        :image-size=\"200\" \r\n        description=\"他还没有文章呢，逛逛别的吧！\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n  import { ref, onMounted,computed} from 'vue';\r\n  import axios from '@/utils/request';\r\n  import { getArticleCoverageFromCOS } from '@/utils/cosService';\r\n  import { ElMessage } from 'element-plus';\r\n  import { useStore } from 'vuex';\r\n  import { useRouter } from 'vue-router';\r\n  import { openUrl } from '@/utils/routeJudge'\r\n\r\n  const currentPage = ref(1);\r\n  const articles = ref([]);\r\n  const store = useStore();\r\n  const id = store.state.favoriteArticleTest;\r\n  const router = useRouter();\r\n\r\n\r\n  // 添加一个锁状态\r\n  let isLoading = false;\r\n  async function load() {\r\n      if (isLoading) return; // 如果已经在加载中，则直接返回不执行新的加载\r\n      isLoading = true; // 开始加载数据，设置锁状态为true\r\n      try {\r\n          if(currentPage.value === 1){\r\n              currentPage.value++;\r\n          }\r\n          await fetchArticleColumn(currentPage.value);\r\n          currentPage.value++; // 只有在请求成功完成后才递增页码\r\n      } catch (error) {\r\n          console.error(error);\r\n          ElMessage.error('滚动时的未知错误');\r\n      } finally {\r\n          isLoading = false; // 请求完成，无论成功或失败，都释放锁状态\r\n      }\r\n  }\r\n\r\nasync function fetchArticleColumn(currentPage) {\r\n  try {\r\n    const response = await axios.get('favorite/article', {\r\n      params: {\r\n        id: id,\r\n        page: currentPage,\r\n        pageSize: 10, \r\n      }\r\n    });\r\n    if (response.data.code === 1 && response.data.data.records.length > 0) {\r\n      const filteredArticles = response.data.data.records.filter(article => article.access === 0); // 只保留公共可见的文章\r\n      const updates = filteredArticles.map(async (article) => {\r\n        const coverPicture = await getArticleCoverageFromCOS(article.id);\r\n        const labels = computed(() => article.label.split('，'));\r\n        return {\r\n          ...article,\r\n          labels,\r\n          coverPicture\r\n        };\r\n      });\r\n      const updatedArticles = await Promise.all(updates);\r\n      articles.value = [...articles.value, ...updatedArticles];\r\n    } else if (response.data.code === 1 && response.data.data.records.length === 0) {\r\n      // ElMessage.info('已加载所有数据');\r\n    } else if (response.data.code === 0 && response.data.msg) {\r\n      ElMessage.error(response.data.msg.toString());\r\n    } else {\r\n      console.error(\"获取专栏的分享列表失败\");\r\n      ElMessage.error(\"获取专栏的分享列表失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取专栏的分享列表失败\", error);\r\n    ElMessage.error('获取专栏的分享列表失败');\r\n  }\r\n}\r\n\r\n\r\n  const goToDetail = (item) =>{\r\n    // const routeLocation = router.resolve({ path: `/TheArticle/${item.id}`});\r\n    // window.open(routeLocation.href, '_blank');\r\n    openUrl(`/TheArticle/${item.id}`)\r\n  }\r\n\r\n  // 生命周期钩子\r\n  onMounted(async () => {\r\n      fetchArticleColumn(currentPage.value);\r\n  });\r\n\r\n</script>\r\n\r\n    \r\n<style scoped>\r\n.hh1{\r\n  height: 81vh;\r\n  overflow-y: auto;\r\n  margin: 0px;\r\n  overflow-x: hidden;\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n}\r\n.cbutton{\r\n  border-bottom: 1px solid rgb(212, 212, 212);;\r\n  padding: 9px 1%;\r\n  width: 98%;\r\n}\r\n.tatitle{\r\n  color: #000; \r\n  text-align: center;\r\n  font-family: Microsoft YaHei;\r\n  font-size: 23px;\r\n  line-height: 1.6; \r\n}\r\n.small{\r\n  position: relative;\r\n  margin: 20px 25px 40px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n  padding-bottom: 5px;\r\n  width: 90%;\r\n  height: 235px;\r\n  border: 1px solid #e8e8e8;\r\n  border-radius: 8px;\r\n  background-color: #fffffc;\r\n  box-shadow: 1px 1px 7px 0px rgb(112 112 112 / 16%);\r\n  transition: transform 0.2s ease-out;\r\n  cursor: pointer;\r\n}\r\n.small:hover {\r\n  transform: translateY(-5px) translateX(5px);\r\n}\r\n.container {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n.one{\r\n  width: 170px;\r\n  height: 140px;\r\n}\r\n.largePicture{\r\n  width: 170px;\r\n  height: 140px;\r\n  border-radius: 8px;\r\n  border: 1px solid #b4b4b4;\r\n}\r\n.two{\r\n  padding: 0px 20px;\r\n  width: 50%;\r\n}\r\nh3{\r\n  color: #000;\r\n  text-align: center;\r\n  font-size: 16px;\r\n  font-weight: 700;\r\n  margin: 10px 0px 0px;\r\n  line-height: 1.6;\r\n}\r\np{\r\n  width: 100%;\r\n  height: 90px;\r\n  margin: 10px 0px 10px;\r\n  color: #000;\r\n  font-size: 14px;\r\n  line-height: 1.6;\r\n}\r\n.attached{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 20px;\r\n  margin-bottom: 10px;\r\n}\r\n.ptime{\r\n  color: #666666;\r\n  font-size: 12px;\r\n  line-height: 1.6;\r\n}\r\n\r\n.cri {\r\n  display: flex; \r\n  align-items: center; \r\n}\r\n\r\n.like-pic {\r\n  width: 20px;\r\n  height: 20px;\r\n  display: inline-block;\r\n}\r\n.cname{\r\n  color: #2d2d2d;;\r\n  font-family: Microsoft YaHei;\r\n  font-size: 13px;\r\n  margin: auto 5px;\r\n  display: inline-block;\r\n}\r\n.lall{\r\n  display: flex;\r\n  padding: 10px 10px;\r\n  justify-content: space-between;\r\n  align-items: flex-end;\r\n  gap: 4px;\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n}\r\n.classify {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  margin-top: 10px;\r\n}\r\n\r\n.cptext {\r\n  color: #000;\r\n  font-family: Microsoft YaHei;\r\n  font-size: 13px;\r\n  line-height: 1.6;\r\n}\r\n\r\n.clab {\r\n   padding: 2px 4px;\r\n   border-radius: 10px;\r\n   background: rgba(240, 240, 240, 0.63);\r\n   backdrop-filter: blur(5px);\r\n   color: #242424;\r\n   font-size: 12px;\r\n   line-height: 1.6; \r\n   cursor: pointer;\r\n   user-select: none;\r\n}\r\n/* 调整滚动条宽度和颜色 */\r\n::-webkit-scrollbar {\r\n    width: 6px; /* 增加纵向滚动条的宽度 */\r\n    height: 8px; /* 增加横向滚动条的高度 */\r\n    background: transparent;\r\n}\r\n\r\n/* 定义滚动条轨道，设置为透明 */\r\n::-webkit-scrollbar-track {\r\n    box-shadow: inset 0 0 8px rgba(0, 0, 0, 0); /* 内阴影 */\r\n    background: transparent; /* 将轨道背景设置为透明 */\r\n}\r\n\r\n/* 定义滑块，设置为浅灰色并增加内阴影 */\r\n::-webkit-scrollbar-thumb {\r\n    box-shadow: inset 0 0 8px rgba(145, 145, 145, 0.3); /* 添加淡灰色内阴影 */\r\n    background-color: #e2e2e2; /* 滑块的颜色改为浅灰色 */\r\n    border-radius: 10px; /* 保持圆角不变 */\r\n}\r\n/* 当鼠标悬停在滚动条滑块上时改变滑块的颜色 */\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: #c8c8c8;\r\n}\r\n</style>"],"mappings":";OAiCwCA,UAA6B;OAI7BC,UAA0B;;gEApChEC,mBAAA,CAEM;EAFDC,KAAK,EAAC;AAAS,I,aAClBD,mBAAA,CAAkC;EAA5BC,KAAK,EAAC;AAAS,GAAC,OAAK,E;;EAExBC,KAAoB,EAApB;IAAA;EAAA;AAAoB;;;EACuBD,KAAK,EAAC,KAAK;EAA0B,0BAAwB,EAAC,KAAK;EAAC,2BAAyB,EAAC;;;;EAEnIA,KAAK,EAAC;AAAW;;EACfA,KAAK,EAAC;AAAK;;;EAGXA,KAAK,EAAC;AAAK;;EAEXA,KAAK,EAAC;AAAuB;;EAG/BA,KAAK,EAAC;AAAM;;EAGRA,KAAK,EAAC;AAAU;iEACnBD,mBAAA,CAA8B;EAAxBC,KAAK,EAAC;AAAQ,GAAC,IAAE;;EACjBA,KAAK,EAAC;AAAM;;EAEfA,KAAK,EAAC;AAAU;iEACnBD,mBAAA,CAA8B;EAAxBC,KAAK,EAAC;AAAQ,GAAC,IAAE;;EAOpBA,KAAK,EAAC;AAAU;;EACdA,KAAK,EAAC;AAAK;iEACZD,mBAAA,CAAoD;EAA/CC,KAAK,EAAC,UAAU;EAACE,GAA6B,EAA7BL;;;EAChBG,KAAK,EAAC;AAAO;;EAElBA,KAAK,EAAC;AAAK;iEACZD,mBAAA,CAAiD;EAA5CC,KAAK,EAAC,UAAU;EAACE,GAA0B,EAA1BJ;;;EAChBE,KAAK,EAAC;AAAO;;EAInBA,KAAK,EAAC;AAAO;;;;6DAzC7BG,UAEM,EACNJ,mBAAA,CAgDM,OAhDNK,UAgDM,GA/COC,MAAA,CAAAC,QAAQ,IAAID,MAAA,CAAAC,QAAQ,CAACC,MAAM,S,+BAAtCC,mBAAA,CAyCM,OAzCNC,UAyCM,I,kBAxCJD,mBAAA,CAuCME,SAAA,QAAAC,WAAA,CAvCqCN,MAAA,CAAAC,QAAQ,GAAxBM,IAAI,EAAEC,KAAK;yBAAtCL,mBAAA,CAuCM;MAvCDR,KAAK,EAAC,OAAO;MAAoCc,GAAG,EAAED,KAAK;MAAGE,OAAK,EAAAC,MAAA,IAAEX,MAAA,CAAAY,UAAU,CAACL,IAAI;QACvFb,mBAAA,CAQM,OARNmB,UAQM,GAPJnB,mBAAA,CAEM,OAFNoB,UAEM,GADJpB,mBAAA,CAA0D;MAArDC,KAAK,EAAC,cAAc;MAAEE,GAAG,EAAEU,IAAI,CAACQ,YAAY;MAAEC,GAAG,EAAC;2CAEzDtB,mBAAA,CAGM,OAHNuB,UAGM,GAFJvB,mBAAA,CAA0B,YAAAwB,gBAAA,CAAlBX,IAAI,CAACY,KAAK,kBAClBzB,mBAAA,CAAuD,KAAvD0B,UAAuD,EAAAF,gBAAA,CAAnBX,IAAI,CAACc,OAAO,iB,KAGpD3B,mBAAA,CA4BM,OA5BN4B,WA4BM,GA3BJC,mBAAA,QAAW,EACX7B,mBAAA,CASM,cARJA,mBAAA,CAGM,OAHN8B,WAGM,GAFJC,WAA8B,EAC9B/B,mBAAA,CAAiD,QAAjDgC,WAAiD,EAAAR,gBAAA,CAA3BX,IAAI,CAACoB,YAAY,iB,GAEzCjC,mBAAA,CAGM,OAHNkC,WAGM,GAFJC,WAA8B,G,kBAC9B1B,mBAAA,CAAsFE,SAAA,QAAAC,WAAA,CAAnDC,IAAI,CAACuB,MAAM,EAApBC,KAAK;2BAA/B5B,mBAAA,CAAsF;QAAhFR,KAAK,EAAC,MAAM;QAA+Bc,GAAG,EAAEsB,KAAK;QAAEC,KAAK,EAAL;SAAM,GAAC,GAAAd,gBAAA,CAAGa,KAAK;wCAGhFR,mBAAA,aAAgB,EAChB7B,mBAAA,CAcM,cAbJ6B,mBAAA,UAAa,EACb7B,mBAAA,CASM,OATNuC,WASM,GARJvC,mBAAA,CAGM,OAHNwC,WAGM,GAFFC,WAAoD,EACpDzC,mBAAA,CAA+C,QAA/C0C,WAA+C,EAAAlB,gBAAA,CAAxBX,IAAI,CAAC8B,SAAS,iB,GAEzC3C,mBAAA,CAGM,OAHN4C,WAGM,GAFFC,WAAiD,EACjD7C,mBAAA,CAAkD,QAAlD8C,WAAkD,EAAAtB,gBAAA,CAA3BX,IAAI,CAACkC,YAAY,iB,KAG9ClB,mBAAA,SAAY,EACZ7B,mBAAA,CAA8C,QAA9CgD,WAA8C,EAAAxB,gBAAA,CAAvBX,IAAI,CAACoC,QAAQ,iB;mEArCiC3C,MAAA,CAAA4C,IAAI,E,mBA0CjFC,YAAA,CAIEC,mBAAA;;IAFG,YAAU,EAAE,GAAG;IAChBC,WAAW,EAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}