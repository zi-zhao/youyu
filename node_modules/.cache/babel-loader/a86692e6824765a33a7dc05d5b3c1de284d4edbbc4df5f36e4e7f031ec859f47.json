{"ast":null,"code":"import { ElMessage } from 'element-plus';\nimport { ref, onMounted } from 'vue';\nimport axios from '@/utils/request';\nimport * as echarts from 'echarts';\nexport default {\n  __name: 'ReadData',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let lineChart;\n    const lineContainer = ref(null);\n    const userRecentCreateData = ref([]);\n    const dates = ref([]); //存放近七天的日期，供折线图的X轴\n\n    const getPastSevenDays = () => {\n      let currentDate = new Date();\n      for (let i = 0; i < 7; i++) {\n        dates.value.unshift(`${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(currentDate.getDate()).padStart(2, '0')}`);\n        currentDate.setDate(currentDate.getDate() - 1);\n      }\n    };\n\n    //获取用户近7天文章阅读量数据\n    async function getSevenReadData() {\n      try {\n        const response = await axios.get(`/articledata/read`);\n        if (response.data.code == 1) {\n          console.log(response.data.data);\n          userRecentCreateData.value = response.data.data;\n          // ElMessage.success('获取用户近7天文章阅读量数据成功');\n        } else if (response.data.code === 0 && response.data.msg) {\n          ElMessage.error(response.data.msg.toString());\n        } else {\n          console.error(\"获取用户近7天文章阅读量数据失败\");\n          ElMessage.error(\"获取用户近7天文章阅读量数据失败\");\n        }\n      } catch (error) {\n        console.error(\"获取用户近7天文章阅读量数据失败\", error);\n        ElMessage.error(\"获取用户近7天文章阅读量数据失败\");\n      }\n    }\n    onMounted(async () => {\n      getPastSevenDays();\n      await getSevenReadData();\n\n      // 折线图配置\n      const lineOption = {\n        title: {\n          text: '近7天阅读量'\n        },\n        tooltip: {},\n        grid: {\n          height: \"70%\"\n        },\n        xAxis: {\n          type: 'category',\n          data: dates.value\n        },\n        yAxis: {\n          type: 'value',\n          splitNumber: 4\n        },\n        series: [{\n          data: userRecentCreateData.value,\n          type: 'line',\n          smooth: true,\n          barWidth: 60\n        }]\n      };\n\n      // 初始化图表\n      lineChart = echarts.init(lineContainer.value);\n      lineChart.setOption(lineOption);\n    });\n    const __returned__ = {\n      get lineChart() {\n        return lineChart;\n      },\n      set lineChart(v) {\n        lineChart = v;\n      },\n      lineContainer,\n      userRecentCreateData,\n      dates,\n      getPastSevenDays,\n      getSevenReadData,\n      get ElMessage() {\n        return ElMessage;\n      },\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      get echarts() {\n        return echarts;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ElMessage","ref","onMounted","axios","echarts","lineChart","lineContainer","userRecentCreateData","dates","getPastSevenDays","currentDate","Date","i","value","unshift","String","getMonth","padStart","getDate","setDate","getSevenReadData","response","get","data","code","console","log","msg","error","toString","lineOption","title","text","tooltip","grid","height","xAxis","type","yAxis","splitNumber","series","smooth","barWidth","init","setOption"],"sources":["D:/有渔/前端源码/YouyuBBS-Q - 副本/youyu-lyn-qtnew-vision-new-2024.1.14/src/page/CreateCenter/components/TheData/ArticleDataPage/ReadData.vue"],"sourcesContent":["<template>\r\n    <div class=\"linechart\">\r\n        <!-- 折线图容器 -->\r\n        <div ref=\"lineContainer\" class=\"linebox\"></div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ElMessage } from 'element-plus';\r\nimport { ref, onMounted} from 'vue';\r\nimport axios from '@/utils/request';\r\nimport * as echarts from 'echarts';\r\n\r\nlet lineChart;\r\nconst lineContainer = ref(null);\r\nconst userRecentCreateData = ref([]);\r\nconst dates = ref([]);//存放近七天的日期，供折线图的X轴\r\n\r\nconst getPastSevenDays = () => {\r\n    let currentDate = new Date();\r\n    for (let i = 0; i < 7; i++) {\r\n        dates.value.unshift(\r\n        `${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(currentDate.getDate()).padStart(2, '0')}`\r\n        );\r\n        currentDate.setDate(currentDate.getDate() - 1);\r\n    }\r\n};\r\n\r\n//获取用户近7天文章阅读量数据\r\nasync function getSevenReadData() {\r\n  try {\r\n    const response = await axios.get(`/articledata/read`)\r\n    if(response.data.code == 1){\r\n        console.log( response.data.data);\r\n        userRecentCreateData.value = response.data.data;\r\n        // ElMessage.success('获取用户近7天文章阅读量数据成功');\r\n    }else if(response.data.code === 0 && response.data.msg){\r\n        ElMessage.error(response.data.msg.toString());\r\n    }else{\r\n        console.error(\"获取用户近7天文章阅读量数据失败\");\r\n        ElMessage.error(\"获取用户近7天文章阅读量数据失败\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取用户近7天文章阅读量数据失败\", error); \r\n    ElMessage.error(\"获取用户近7天文章阅读量数据失败\");\r\n  }\r\n}\r\n\r\n\r\n\r\nonMounted(async () => {\r\n    getPastSevenDays();\r\n    await getSevenReadData();\r\n\r\n    // 折线图配置\r\n    const lineOption = {\r\n        title: {\r\n            text: '近7天阅读量'\r\n        },\r\n        tooltip: {},\r\n        grid:{\r\n            height: \"70%\"\r\n        },\r\n        xAxis: {\r\n            type: 'category',\r\n            data: dates.value,\r\n        },\r\n        yAxis: {\r\n            type: 'value',\r\n            splitNumber: 4\r\n        },\r\n        series: [{\r\n            data: userRecentCreateData.value,\r\n            type: 'line',\r\n            smooth: true,\r\n            barWidth: 60\r\n        }]\r\n    };\r\n\r\n    // 初始化图表\r\n    lineChart = echarts.init(lineContainer.value);\r\n    lineChart.setOption(lineOption);\r\n});\r\n\r\n\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.linechart{\r\n    border: 1px solid #eaeaea;\r\n    box-shadow: 0px 0px 20px 0px rgba(96, 111, 160, 0.25), 0px 4px 4px 0px rgb(0 0 0 / 21%);\r\n    border-radius: 20px;\r\n    padding: 20px 30px;\r\n}\r\n.linebox{\r\n    width: 100%;\r\n    height: 300px;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}